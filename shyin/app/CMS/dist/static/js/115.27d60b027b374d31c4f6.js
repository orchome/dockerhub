webpackJsonp([115],{"/Tmy":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s("Xxa5"),a=s.n(r),o=s("exGp"),n=s.n(o),i=s("Dd8w"),l=s.n(i),c=s("NYxO"),p=s("5Vl1"),u=s("pQT1"),m=s("msXN"),_=s("qwJR"),d={components:{UploadImg:p.a,MnqUploadImg:u.a,InputNumber:_.a},name:"",mixins:[m.a],computed:l()({productType:function(){var t=this.ruleForm.type.indexOf("1")>-1,e=this.ruleForm.type.indexOf("2")>-1;return t&&!e?1:!t&&e?2:t&&e?3:"0"}},Object(c.b)({pornPicAllCat:"pornPicAllCat"}),{isbianxiantui:function(){return window.location.href.indexOf("bianxiantui")>-1}}),props:{},data:function(){return{cps:!1,app:!1,sp1:!1,sp2:!1,all:!1,rules:{location:[{required:!0,message:"请选择上架位置",trigger:"change"}],type:[{type:"array",required:!0,message:"请至少选择一个平台",trigger:"change"}],tag:[{type:"array",required:!0,message:"请至少选择一个标签",trigger:"change"}],title:[{required:!0,message:"请输入图册名称",trigger:"blur"}]},ruleForm:{pic:"",cat_id_cps:"",cat_id_shop:"",cat_id_sp1:"",cat_id_sp2:"",sort_cps:1,location_cps:"",sort_sp1:1,location_sp1:"",sort_sp2:1,location_sp2:"",sort_shop:1,location_shop:"",type:[],tag:[],charge_node:"",title:""},cats:[],sp1_cats:[],sp2_cats:[]}},watch:{"ruleForm.charge_node":function(t){t<=0&&(this.ruleForm.charge_node=1)}},methods:{goBack:function(){this.$router.go(-1)},applicationChange:function(t){this.cps=t.indexOf("1")>=0,this.app=t.indexOf("2")>=0,this.sp1=t.indexOf("3")>=0,this.sp2=t.indexOf("4")>=0,this.all=t.length>0},getAllCat:function(){var t=n()(a.a.mark(function t(){var e,s,r;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.triggerActionsFn("getMnqCategory",{is_all:1,status:1});case 2:return e=t.sent,t.next=5,this.triggerActionsFn("getMnqCategory",{is_all:1,status:1,is_miniprogram:1,client:1});case 5:return s=t.sent,t.next=8,this.triggerActionsFn("getMnqCategory",{is_all:1,status:1,is_miniprogram:1,client:2});case 8:r=t.sent,200==e.code&&(this.cats=e.data),200==s.code&&(this.sp1_cats=s.data),200==r.code&&(this.sp2_cats=r.data);case 12:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),addFn:function(){var t=n()(a.a.mark(function t(e){var s,r,o,n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s="",r="",o="",n="",!this.sp1){t.next=12;break}if(""!=e.cat_id_sp1){t.next=8;break}return this.warningMsgFn("请选择趣撸小程序图片分类"),t.abrupt("return");case 8:if(""!=e.location_sp1){t.next=11;break}return this.warningMsgFn("请选择趣撸小程序上传位置"),t.abrupt("return");case 11:o={title:e.title,album_type:e.cat_id_sp1,tag:e.tag.toString(),pic:e.pic,position:e.location_sp1,sort:e.sort_sp1,charge_node:e.charge_node,is_miniprogram:"1",client:1};case 12:if(!this.sp2){t.next=20;break}if(""!=e.cat_id_sp2){t.next=16;break}return this.warningMsgFn("请选择小优圈小程序图片分类"),t.abrupt("return");case 16:if(""!=e.location_sp2){t.next=19;break}return this.warningMsgFn("请选择小优圈小程序上传位置"),t.abrupt("return");case 19:n={title:e.title,album_type:e.cat_id_sp2,tag:e.tag.toString(),pic:e.pic,position:e.location_sp2,sort:e.sort_sp2,charge_node:e.charge_node,is_miniprogram:"1",client:2};case 20:if(!this.app){t.next=28;break}if(""!=e.cat_id_shop){t.next=24;break}return this.warningMsgFn("请选择华丽图片分类"),t.abrupt("return");case 24:if(""!=e.location_shop){t.next=27;break}return this.warningMsgFn("请选择华丽图片上传位置"),t.abrupt("return");case 27:r={title:e.title,album_type:e.cat_id_shop,pic:e.pic,location:e.location_shop,sort:e.sort_shop};case 28:if(!this.cps){t.next=36;break}if(""!=e.cat_id_cps){t.next=32;break}return this.warningMsgFn("请选择CPS图片分类"),t.abrupt("return");case 32:if(""!=e.location_cps){t.next=35;break}return this.warningMsgFn("请选择CPS上传位置"),t.abrupt("return");case 35:s={title:e.title,album_type:e.cat_id_cps,tag:e.tag.toString(),pic:e.pic,position:e.location_cps,sort:e.sort_cps,charge_node:e.charge_node};case 36:this.postPhotoFn(s,r,o,n);case 37:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),postPhotoFn:function(){var t=n()(a.a.mark(function t(e,s,r,o){var n,i,l,c;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=void 0,i=void 0,l=void 0,c=void 0,""==e){t.next=9;break}return t.next=7,this.triggerActionsFn("postLookPicCreate",e);case 7:(n=t.sent)&&200==n.code&&this.successMsgFn("CPS平台添加组图成功");case 9:if(""==s){t.next=14;break}return t.next=12,this.triggerActionsFn("postPornPhotoCreate",s);case 12:(i=t.sent)&&200==i.code&&this.successMsgFn("华丽图片添加组图成功");case 14:if(""==r){t.next=19;break}return t.next=17,this.triggerActionsFn("postLookPicCreate",r);case 17:(l=t.sent)&&200==l.code&&this.successMsgFn("小程序平台添加组图成功");case 19:if(""==o){t.next=24;break}return t.next=22,this.triggerActionsFn("postLookPicCreate",o);case 22:(c=t.sent)&&200==c.code&&this.successMsgFn("小程序平台添加组图成功");case 24:if(""==e||n){t.next=26;break}return t.abrupt("return");case 26:if(""==s||i){t.next=28;break}return t.abrupt("return");case 28:if(""==r||l){t.next=30;break}return t.abrupt("return");case 30:if(""==o||c){t.next=32;break}return t.abrupt("return");case 32:this.resetForm("ruleForm");case 33:case"end":return t.stop()}},t,this)}));return function(e,s,r,a){return t.apply(this,arguments)}}(),submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;if(e.ruleForm.pic.split(",").length<4)e.warningMsgFn("至少上传4张图片");else if(""!==e.ruleForm.pic){var s=e._.cloneDeep(e.ruleForm);e.$nextTick(function(){e.addFn(s)})}else e.warningMsgFn("请上传组图")})},postPornPhotoCreate:function(){var t=n()(a.a.mark(function t(e){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.triggerActionsFn("postPornPhotoCreate",e);case 2:(s=t.sent)&&200==s.code&&(this.successMsgFn("上传组图成功"),this.resetForm("ruleForm"));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),resetForm:function(t){setTimeout(function(){location.reload()},2e3),this.$refs[t].resetFields()}},created:function(){var t=n()(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.getAllCat(),t.next=3,this.triggerActionsFn("getPornPicGetCategory",{},!0);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),mounted:function(){}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"lookpic-edit-tab"},[s("el-form",{ref:"ruleForm",attrs:{"label-position":"right","label-width":"100px",model:t.ruleForm,size:"small",rules:t.rules}},[s("el-form-item",{attrs:{label:"平台类别",prop:"type"}},[s("el-checkbox-group",{on:{change:t.applicationChange},model:{value:t.ruleForm.type,callback:function(e){t.$set(t.ruleForm,"type",e)},expression:"ruleForm.type"}},[s("el-checkbox",{attrs:{label:"1",name:"type"}},[t._v("CPS")]),t._v(" "),s("el-checkbox",{attrs:{disabled:t.isbianxiantui,label:"2",name:"type"}},[t._v("华丽图片")]),t._v(" "),s("el-checkbox",{attrs:{label:"3",name:"type"}},[t._v("趣撸小程序")]),t._v(" "),s("el-checkbox",{attrs:{label:"4",name:"type"}},[t._v("小优圈小程序")])],1)],1),t._v(" "),s("el-form-item",{staticStyle:{width:"300px"},attrs:{prop:"title",label:"图册名称"}},[s("el-input",{attrs:{placeholder:"输入图册名称"},model:{value:t.ruleForm.title,callback:function(e){t.$set(t.ruleForm,"title",e)},expression:"ruleForm.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"上传组图",required:""}},[s("MnqUploadImg",{staticClass:"checkmnq",attrs:{picture:t.ruleForm.pic,"list-type":"picture-card-drag","class-name":"list",is_miniprogram:"1",mnq:"",multiple:"","edit-visible":!1},on:{"update:picture":function(e){t.$set(t.ruleForm,"pic",e)}}})],1),t._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.all,expression:"all"}],attrs:{label:"图片分类",required:""}},[s("ul",{staticClass:"location-wrapper"},[s("li",{directives:[{name:"show",rawName:"v-show",value:t.cps,expression:"cps"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("CPS分类")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择图片分类"},model:{value:t.ruleForm.cat_id_cps,callback:function(e){t.$set(t.ruleForm,"cat_id_cps",e)},expression:"ruleForm.cat_id_cps"}},t._l(t.cats,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.app,expression:"app"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("华丽图片分类")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择图片分类"},model:{value:t.ruleForm.cat_id_shop,callback:function(e){t.$set(t.ruleForm,"cat_id_shop",e)},expression:"ruleForm.cat_id_shop"}},t._l(t.pornPicAllCat,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.sp1,expression:"sp1"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("趣撸小程序")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择图片分类"},model:{value:t.ruleForm.cat_id_sp1,callback:function(e){t.$set(t.ruleForm,"cat_id_sp1",e)},expression:"ruleForm.cat_id_sp1"}},t._l(t.sp1_cats,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.sp2,expression:"sp2"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("小优圈小程序")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择图片分类"},model:{value:t.ruleForm.cat_id_sp2,callback:function(e){t.$set(t.ruleForm,"cat_id_sp2",e)},expression:"ruleForm.cat_id_sp2"}},t._l(t.sp2_cats,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])])]),t._v(" "),t.all?s("el-form-item",{attrs:{label:"上架位置",required:""}},[s("ul",{staticClass:"location-wrapper"},[s("li",{directives:[{name:"show",rawName:"v-show",value:t.cps,expression:"cps"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("CPS位置")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择上架位置"},on:{change:function(e){t.ruleForm.sort_cps=1}},model:{value:t.ruleForm.location_cps,callback:function(e){t.$set(t.ruleForm,"location_cps",e)},expression:"ruleForm.location_cps"}},[s("el-option",{attrs:{label:"热门推荐",value:"1"}}),t._v(" "),s("el-option",{attrs:{label:"图册架",value:"2"}})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.ruleForm.location_cps,expression:"ruleForm.location_cps!=''"}],staticClass:"location-item"},[s("span",{staticClass:"location-text sort"},[t._v("排序")]),t._v(" "),s("input-number",{attrs:{empty:2==t.ruleForm.location_cps,sort:t.ruleForm.sort_cps,min:1,max:1==t.ruleForm.location_cps?6:1e10,text:1==t.ruleForm.location_cps?"数值1-6整数，数字越小越排在前面":"请选择整数，最小为1，数字越小越排在后面"},on:{"update:sort":function(e){t.$set(t.ruleForm,"sort_cps",e)}}})],1)]),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.app,expression:"app"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("华丽图片位置")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择上架位置"},model:{value:t.ruleForm.location_shop,callback:function(e){t.$set(t.ruleForm,"location_shop",e)},expression:"ruleForm.location_shop"}},[s("el-option",{attrs:{label:"最近上新",value:"0"}}),t._v(" "),s("el-option",{attrs:{label:"热门精选",value:"1"}})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.ruleForm.location_shop,expression:"ruleForm.location_shop!=''"}],staticClass:"location-item"},[s("span",{staticClass:"location-text sort"},[t._v("排序")]),t._v(" "),s("input-number",{attrs:{sort:t.ruleForm.sort_shop,min:1,text:"请选择整数，最小为1，数字越小越排在后面"},on:{"update:sort":function(e){t.$set(t.ruleForm,"sort_shop",e)}}})],1)]),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.sp1,expression:"sp1"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("趣撸小程序")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择上架位置"},on:{change:function(e){t.ruleForm.sort_sp1=1}},model:{value:t.ruleForm.location_sp1,callback:function(e){t.$set(t.ruleForm,"location_sp1",e)},expression:"ruleForm.location_sp1"}},[s("el-option",{attrs:{label:"热门推荐",value:"1"}}),t._v(" "),s("el-option",{attrs:{label:"图册架",value:"2"}})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.ruleForm.location_sp1,expression:"ruleForm.location_sp1!=''"}],staticClass:"location-item"},[s("span",{staticClass:"location-text sort"},[t._v("排序")]),t._v(" "),s("input-number",{attrs:{empty:2==t.ruleForm.location_sp1,sort:t.ruleForm.sort_sp1,min:1,max:1==t.ruleForm.location_sp1?6:1e10,text:1==t.ruleForm.location_sp1?"数值1-6整数，数字越小越排在前面":"请选择整数，最小为1，数字越小越排在后面"},on:{"update:sort":function(e){t.$set(t.ruleForm,"sort_sp1",e)}}})],1)]),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.sp2,expression:"sp2"}]},[s("div",{staticClass:"location-item"},[s("span",{staticClass:"location-text"},[t._v("小优圈小程序")]),t._v(" "),s("el-select",{attrs:{placeholder:"请选择上架位置"},on:{change:function(e){t.ruleForm.sort_sp2=1}},model:{value:t.ruleForm.location_sp2,callback:function(e){t.$set(t.ruleForm,"location_sp2",e)},expression:"ruleForm.location_sp2"}},[s("el-option",{attrs:{label:"热门推荐",value:"1"}}),t._v(" "),s("el-option",{attrs:{label:"图册架",value:"2"}})],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.ruleForm.location_sp2,expression:"ruleForm.location_sp2!=''"}],staticClass:"location-item"},[s("span",{staticClass:"location-text sort"},[t._v("排序")]),t._v(" "),s("input-number",{attrs:{empty:2==t.ruleForm.location_sp2,sort:t.ruleForm.sort_sp2,min:1,max:1==t.ruleForm.location_sp2?6:1e10,text:1==t.ruleForm.location_sp2?"数值1-6整数，数字越小越排在前面":"请选择整数，最小为1，数字越小越排在后面"},on:{"update:sort":function(e){t.$set(t.ruleForm,"sort_sp2",e)}}})],1)])])]):t._e(),t._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.cps||t.sp1||t.sp2,expression:"cps || sp1 || sp2"}],attrs:{label:"开始收费节点"}},[s("input-number",{attrs:{empty:"",sort:t.ruleForm.charge_node,min:1,text:"选填，默认第三张"},on:{"update:sort":function(e){t.$set(t.ruleForm,"charge_node",e)}}})],1),t._v(" "),t.cps||t.sp1||t.sp2?s("el-form-item",{attrs:{label:"标签",prop:"tag"}},[s("el-checkbox-group",{model:{value:t.ruleForm.tag,callback:function(e){t.$set(t.ruleForm,"tag",e)},expression:"ruleForm.tag"}},[s("el-checkbox",{attrs:{label:"0",name:"type"}},[t._v("普通")]),t._v(" "),s("el-checkbox",{attrs:{label:"1",name:"type"}},[t._v("火爆")])],1)],1):t._e(),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("保存")]),t._v(" "),s("el-button",{attrs:{size:"small"},on:{click:t.goBack}},[t._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var v=s("VU/8")(d,h,!1,function(t){s("8Qb6")},null,null);e.default=v.exports},"8Qb6":function(t,e,s){var r=s("lZmy");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);s("rjj0")("4911d216",r,!0)},lZmy:function(t,e,s){(t.exports=s("FZ+f")(!1)).push([t.i,"\n.el-upload-list--picture-card .el-upload-list__item-status-label {\n  display: block !important;\n  right: -30px;\n  top: -12px;\n  width: 80px;\n  height: 48px;\n}\n.el-upload-list--picture-card .el-upload-list__item-status-label i {\n    font-size: 24px;\n    margin-top: 22px;\n}\n.el-upload-list--picture-card .el-upload-list__item-status-label .pay-icon {\n    top: 18px;\n    left: -2px;\n    font-size: 16px;\n    font-style: inherit;\n    position: relative;\n    color: red;\n}\n.el-upload-list--picture-card .el-upload-list__item-status-label .pay-icon.first {\n      color: #ff9900;\n}\n.picture-mark-wrap {\n  position: relative;\n}\n.picture-mark-wrap .mark {\n    position: absolute;\n    right: -10px;\n    z-index: 1000;\n    display: block;\n    width: 300px;\n    -webkit-transform: translate(100%, -100%);\n            transform: translate(100%, -100%);\n    font-size: 12px;\n    color: #606266;\n}\n.location-wrapper li {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin-bottom: 10px;\n}\n.location-wrapper li:last-child {\n    margin-bottom: 0;\n}\n.location-wrapper .location-item {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  margin-right: 10px;\n}\n.location-wrapper .location-text {\n  display: inline-block;\n  width: 100px;\n  color: #999999;\n  font-size: 14px;\n}\n.location-wrapper .location-text.sort {\n    width: 50px;\n}\n",""])}});