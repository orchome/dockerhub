webpackJsonp([16],{FOk8:function(n,t,e){var r=e("yvTK");"string"==typeof r&&(r=[[n.i,r,""]]),r.locals&&(n.exports=r.locals);e("rjj0")("dcdbbd14",r,!0)},x3we:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("mvHQ"),o=e.n(r),a=e("Xxa5"),s=e.n(a),i=e("exGp"),u=e.n(i),l=e("RRo+"),c=e.n(l),d=e("Dd8w"),m=e.n(d),p=e("NYxO"),f={computed:m()({isEdit:function(){return this.$route.fullPath.indexOf("/edit/")>-1}},Object(p.b)({})),data:function(){return{options:[],loading:!1,ruleForm:{name:"",book_id:"",sort:0},rules:{name:[{required:!0,message:"请输入卷轴名称",trigger:"blur"}],book_id:[{required:!0,message:"请选择小说",trigger:"change"}],sort:[{validator:function(n,t,e){if(!t&&0!=t)return e(new Error("请输入序号"));setTimeout(function(){c()(Number(t))?e():e(new Error("请输入数字值"))},1e3)},trigger:"blur",required:!0}]},bookList:[],submitLoding:!1,lastVolumeSort:"该小说目前最新卷轴序号为0"}},methods:{changeNovelFn:function(){var n=u()(s.a.mark(function n(t){var e;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getVolumeSort",{book_id:t});case 2:200==(e=n.sent).code&&(this.lastVolumeSort=e.data?"该小说目前最新卷轴序号为"+e.data:"该小说目前没有卷轴");case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),getVolumeInfoFn:function(){var n=u()(s.a.mark(function n(){var t;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getVolumeInfo",{id:this.$route.params.id});case 2:200==(t=n.sent).code&&(this.options=[{id:t.data.book_id,name:t.data.book_name}],this.ruleForm={name:t.data.name,sort:t.data.sort,book_id:t.data.book_id},this.changeNovelFn(t.data.book_id));case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),resetForm:function(n){this.$router.push("/novelManage/volume"),this.$refs[n].resetFields()},remoteMethod:function(n){var t=this;""!==n?(this.loading=!0,setTimeout(function(){t.loading=!1,t.options=t.bookList.filter(function(t){return t.id.indexOf(n)>-1||t.name.indexOf(n)>-1})},200)):this.options=[]},submitForm:function(n){var t=this;this.$refs[n].validate(function(n){if(!n)return!1;t.submitLoding=!0,t.isEdit?t.postVolumeUpdateFn():t.postVolumeCreateFn()})},getAjaxGetBookFn:function(){var n=u()(s.a.mark(function n(){var t;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getAjaxGetBook");case 2:200==(t=n.sent).code&&(t.data.forEach(function(n){return n.id=n.id+""}),this.bookList=t.data);case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),postVolumeCreateFn:function(){var n=u()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postVolumeCreate",this.ruleForm);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"添加卷轴成功",type:"success"}),this.$router.push("/novelManage/volume")),this.loading=!1;case 5:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),postVolumeUpdateFn:function(){var n=u()(s.a.mark(function n(){var t;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(t=JSON.parse(o()(this.ruleForm))).id=this.$route.params.id,n.next=4,this.$store.dispatch("postVolumeUpdate",t);case 4:200==n.sent.code&&(this.$message({duration:1500,message:"修改卷轴成功",type:"success"}),this.$router.push("/novelManage/volume")),this.loading=!1;case 7:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}()},created:function(){var n=u()(s.a.mark(function n(){return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isEdit){n.next=4;break}this.getVolumeInfoFn(),n.next=6;break;case 4:return n.next=6,this.getAjaxGetBookFn();case 6:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),mounted:function(){}},h={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticStyle:{width:"400px"}},[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:n.ruleForm,rules:n.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"卷轴名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"请输入分类名称"},model:{value:n.ruleForm.name,callback:function(t){n.$set(n.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n._v(" "),e("el-form-item",{attrs:{label:"小说名称",prop:"book_id"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入小说名称",filterable:"",remote:"","remote-method":n.remoteMethod,loading:n.loading},on:{change:n.changeNovelFn},model:{value:n.ruleForm.book_id,callback:function(t){n.$set(n.ruleForm,"book_id",t)},expression:"ruleForm.book_id"}},n._l(n.options,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[e("span",{staticStyle:{float:"left"}},[n._v(n._s(t.id))]),n._v(" "),e("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[n._v(n._s(t.name))])])}))],1),n._v(" "),e("el-form-item",{attrs:{label:"排序",prop:"sort"}},[e("div",{staticStyle:{position:"relative"}},[e("el-input",{attrs:{placeholder:"请输入卷轴序号"},model:{value:n.ruleForm.sort,callback:function(t){n.$set(n.ruleForm,"sort",t)},expression:"ruleForm.sort"}}),n._v(" "),e("span",{staticStyle:{position:"absolute",right:"-10px",transform:"translate(100%,-50%)",top:"50%",color:"rgba(0,0,0,0.5)"}},[n._v(n._s(n.lastVolumeSort))])],1)]),n._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:n.submitLoding},on:{click:function(t){n.submitForm("ruleForm")}}},[n._v("保存")]),n._v(" "),e("el-button",{on:{click:function(t){n.resetForm("ruleForm")}}},[n._v("返回")])],1)],1)],1)])},staticRenderFns:[]};var v=e("VU/8")(f,h,!1,function(n){e("FOk8")},null,null);t.default=v.exports},yvTK:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});