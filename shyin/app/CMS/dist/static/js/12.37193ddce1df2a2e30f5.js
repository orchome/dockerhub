webpackJsonp([12],{"9RaU":function(t,e,o){var a=o("GBUW");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("4de4a078",a,!0)},GBUW:function(t,e,o){(t.exports=o("FZ+f")(!1)).push([t.i,"\n.push-pool .el-button + a {\n  margin-left: 0;\n}\n.push-pool-dialog .el-dialog {\n  width: 600px;\n}\n.push-pool-dialog .form-title .el-form-item__label {\n  width: 79px;\n}\n.push-pool-dialog .form-title .el-input {\n  width: 240px;\n}\n.push-pool-dialog .el-form-item__error {\n  left: 79px;\n}\n",""])},"X+FY":function(t,e,o){"use strict";(function(t){var a=o("Xxa5"),i=o.n(a),r=o("exGp"),n=o.n(r),l=o("Dd8w"),s=o.n(l),u=o("NYxO");e.a={computed:s()({},Object(u.b)({}),{dialogTitle:function(){return"book"==this.poolType?"新增小说":"新增美图"},poolType:function(){return this.$route.meta.type}}),watch:{},data:function(){return{booksOptions:[],albumOptions:[],loading:!1,params:{page:1,id:""},dataList:{data:[],total:0},form:{album_id:"",book_id:"",sex:1},rules:{album_id:[{required:!0,message:"请选择相册",trigger:"change"}],book_id:[{required:!0,message:"请选择书籍",trigger:"change"}]},dialogShow:!1,loadingSearch:!1}},created:function(){this.params.id=this.$route.params.id,this.getListDataFn()},methods:{addFn:function(){var t=this;this.dialogShow=!0,this.$nextTick(function(){t.$refs.form.resetFields()}),"book"==this.poolType?this.remoteMethod():this.getCPSSmartPushAlbum()},remoteMethod:function(e){var o=this;return n()(i.a.mark(function a(){var r;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o.loadingSearch=!0,e=t.trim(e),a.next=4,o.$store.dispatch("getCPSSmartPushBooks",{name:e});case 4:r=a.sent,o.booksOptions=r.data,o.loadingSearch=!1;case 7:case"end":return a.stop()}},a,o)}))()},getCPSSmartPushAlbum:function(){var e=n()(i.a.mark(function e(){var o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingSearch=!0,a=t.trim(a),e.next=4,this.triggerActionsFn("getCPSSmartPushAlbum",{name:a});case 4:(o=e.sent)&&(this.albumOptions=o.data,this.loadingSearch=!1);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var o={};o.id=e.params.id,"book"==e.poolType?(o.sex=e.form.sex,o.book_id=e.form.book_id.toString()):o.album_id=e.form.album_id.toString(),e.submitDataFn(o)})},getListDataFn:function(){var t=n()(i.a.mark(function t(){var e,o,a,r;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,o=this.params,a=void 0===o?{}:o,e.loading=!0,t.next=5,e.triggerActionsFn("getSmartPushPoolById",a);case 5:(r=t.sent)&&(this.dataList={data:r.data,total:r.meta.total}),e.loading=!1;case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleCurrentChange:function(t){this.params.page=t,this.getListDataFn()},resetForm:function(t){this.dialogShow=!1,this.form={album_id:"",book_id:"",sex:1},this.$refs[t].resetFields()},submitDataFn:function(){var t=n()(i.a.mark(function t(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"postSmartPushPoolById";return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.triggerActionsFn(o,e);case 2:200==t.sent.code&&(this.successMsgFn("添加成功！"),this.getListDataFn(),this.resetForm("form"));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),deleteSmartPushPoolById:function(){var t=n()(i.a.mark(function t(e,o){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.triggerActionsFn("deleteSmartPushPoolById",{id:e,pool_id:o});case 2:200==t.sent.code&&(this.successMsgFn("删除成功！"),this.getListDataFn());case 4:case"end":return t.stop()}},t,this)}));return function(e,o){return t.apply(this,arguments)}}()}}}).call(e,o("7t+N"))},kd3N:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("X+FY"),i={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container push-pool"},[o("div",{staticClass:"bar flex"},[o("div",{staticClass:"flex-left"}),t._v(" "),o("div",{staticClass:"flex-right"},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.addFn}},[t._v("新增")])],1)]),t._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:t.dataList.data,border:"",stripe:""}},[o("el-table-column",{attrs:{prop:"book"==t.poolType?"book_id":"album_id",label:"book"==t.poolType?"书籍ID":"相册ID",width:"100",fixed:""}}),t._v(" "),o("el-table-column",{attrs:{prop:"title",label:"book"==t.poolType?"书籍名称":"相册标题","min-width":"100","show-overflow-tooltip":"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s("book"==t.poolType?e.row.book?e.row.book.name:"-":e.row.album?e.row.album.title:"-")+"\n            ")]}}])}),t._v(" "),"book"==t.poolType?o("el-table-column",{attrs:{prop:"sex",label:"性别","min-width":"120","show-overflow-tooltip":"",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(1==e.row.sex?"男":"女")+"\n            ")]}}])}):t._e(),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-popover",{attrs:{placement:"top",width:"100"},model:{value:e.row.delete,callback:function(o){t.$set(e.row,"delete",o)},expression:"scope.row.delete"}},[o("p",[t._v("确认删除选择的内容？")]),t._v(" "),o("div",{staticStyle:{"text-align":"right",margin:"0"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.row.delete=!1}}},[t._v("取消")]),t._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){t.deleteSmartPushPoolById(e.row.id,e.row.pool_id),e.row.delete=!1}}},[t._v("确定")])],1),t._v(" "),o("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(t){e.row.delete=!0}},slot:"reference"},[t._v("删除")])],1)]}}])})],1),t._v(" "),o("div",{staticClass:"pagination-container clearfix"},[o("div",{staticClass:"float-left"},[o("global-pagination",{attrs:{"current-page":t.params.page,"page-size":t.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:t.dataList.total},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)]),t._v(" "),o("el-dialog",{staticClass:"push-pool-dialog",attrs:{title:t.dialogTitle,visible:t.dialogShow,"close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogShow=e},closed:function(e){t.resetForm("form")}}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules}},["book"==t.poolType?o("el-form-item",{staticClass:"form-title",attrs:{label:"性别",prop:"sex","label-width":"120px;"}},[o("el-radio-group",{model:{value:t.form.sex,callback:function(e){t.$set(t.form,"sex",e)},expression:"form.sex"}},[o("el-radio",{attrs:{label:1}},[t._v("男")]),t._v(" "),o("el-radio",{attrs:{label:2}},[t._v("女")])],1)],1):t._e(),t._v(" "),"book"==t.poolType?o("el-form-item",{attrs:{label:"小说名称","label-width":"120px;",prop:"book_id"}},[o("el-select",{attrs:{filterable:"",remote:"",multiple:"",placeholder:"请输入小说ID或小说名称搜索","remote-method":t.remoteMethod,loading:t.loadingSearch},model:{value:t.form.book_id,callback:function(e){t.$set(t.form,"book_id",e)},expression:"form.book_id"}},t._l(t.booksOptions,function(t){return o("el-option",{key:t.book_id,attrs:{label:t.name,value:t.book_id}})}))],1):t._e(),t._v(" "),"album"==t.poolType?o("el-form-item",{attrs:{label:"相册ID","label-width":"120px;",prop:"album_id"}},[o("el-select",{attrs:{filterable:"",remote:"",multiple:"",placeholder:"请输入相册ID或相册名称搜索","remote-method":t.getCPSSmartPushAlbum,loading:t.loadingSearch},model:{value:t.form.album_id,callback:function(e){t.$set(t.form,"album_id",e)},expression:"form.album_id"}},t._l(t.albumOptions,function(t){return o("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1):t._e()],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.resetForm("form")}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("form")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=function(t){o("9RaU")},n=o("VU/8")(a.a,i,!1,r,null,null);e.default=n.exports}});