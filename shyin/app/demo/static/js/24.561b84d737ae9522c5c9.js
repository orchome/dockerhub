webpackJsonp([24],{X4po:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("Xxa5"),s=e.n(n),i=e("exGp"),o=e.n(i),l=e("Dd8w"),r=e.n(l),c=e("cS7h"),p=e("688b"),k=e("GQaK"),v=e("SJI6"),h=e("qERK"),u=e("+VX7"),d=e("TIfe"),g={name:"rank",components:{Navigation:c.a,BookInfo:p.a,loading:h.a,GoodBooks:u.a},computed:r()({},Object(v.mapGetters)({sex:"sex",loveRank:"loveRank",clickRank:"clickRank",loveRankPagination:"loveRankPagination",clickRankPagination:"clickRankPagination",templet_num:"templet_num"}),{bookData:function(){return 1==this.templet_num?1==this.index?this.loveRank:this.clickRank:2==this.templet_num?1==this.index?(this.topThree=this.loveRank.slice(0,3),this.loveRank.slice(3,this.loveRank.length)):(this.topThree=this.clickRank.slice(0,3),this.clickRank.slice(3,this.clickRank.length)):void 0},isHaveData:function(){return 1==this.index?this.loveRankIsHaveData:this.clickRankIsHaveData}}),data:function(){return{index:1,loveRankParams:{sex:1},loveRankIsHaveData:!0,clickRankParams:{sex:1},clickRankIsHaveData:!0,scroll:"",pullingUpStart:!1,topThree:[]}},methods:{changeTabbarFn:function(t){this.index!=t&&(this.index=t,this.scroll&&this.scroll.scrollTo(0,0),(1==this.index&&this.loveRankIsHaveData||3==this.index&&this.clickRankIsHaveData)&&this.scroll.openPullUp())},changeSexFn:function(t){this.$store.dispatch("getSexAction",t),Object(d.i)(t),this.$store.dispatch("clearList"),this.getBooksClickRankFn()},getBooksLoveRankFn:function(){var t=o()(s.a.mark(function t(){var a,e,n=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a={}).sex=this.sex||1,a.page=this.loveRankPagination.current_page||1,t.next=5,this.$store.dispatch("getBooksLoveRank",a);case 5:e=t.sent,this.pullingUpStart=!1,this.$nextTick(function(){200==e.code&&(e.pagination.current_page>=e.pagination.total_pages?(n.loveRankIsHaveData=!1,n.scroll&&(n.scroll.closePullUp(),n.scroll.refresh())):(n.loveRankIsHaveData=!0,n.scroll&&(n.scroll.finishPullUp(),n.scroll.refresh())))});case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getBooksClickRankFn:function(){var t=o()(s.a.mark(function t(){var a,e,n=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(a={}).sex=this.sex||1,a.page=this.clickRankPagination.current_page||1,t.next=5,this.$store.dispatch("getBooksClickRank",a);case 5:e=t.sent,this.pullingUpStart=!1,this.$nextTick(function(){200==e.code&&(e.pagination.current_page>=e.pagination.total_pages?(n.clickRankIsHaveData=!1,n.scroll&&(n.scroll.closePullUp(),n.scroll.refresh())):(n.clickRankIsHaveData=!0,n.scroll&&(n.scroll.finishPullUp(),n.scroll.refresh())),e.pagination.current_page>=3&&(n.clickRankIsHaveData=!1,n.scroll&&(n.scroll.closePullUp(),n.scroll.refresh())))});case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),initBScroll:function(){var t=o()(s.a.mark(function t(){var a=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:""==this.scroll?this.$nextTick(function(){a.scroll=new k.a(a.$refs.wrapper,{click:!0,pullUpLoad:{threshold:0}}),a.scroll.on("pullingUp",function(){a.isHaveData&&(a.pullingUpStart=!0,a.getDataFn())})}):this.scroll.refresh();case 1:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getDataFn:function(){1==this.index?this.getBooksLoveRankFn():this.getBooksClickRankFn()}},created:function(){this.getBooksLoveRankFn(),this.getBooksClickRankFn()},mounted:function(){this.initBScroll(),2==this.templet_num&&(this.index=3)},beforeDestroy:function(){this.scroll&&this.scroll.destroy()}},f={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{class:[1==t.sex?"boy":"girl",1==t.templet_num?"rank":"rank2"]},[e("navigation",[t._v("排行榜")]),t._v(" "),1==t.templet_num?e("div",{staticStyle:{height:"100%"}},[e("div",{staticClass:"rank-tabbar"},[e("div",{staticClass:"rank-tabbar-item",class:{active:1==t.index},on:{click:function(a){t.changeTabbarFn(1)}}},[e("span",[t._v("收藏榜")])]),t._v(" "),e("div",{staticClass:"rank-tabbar-item",class:{active:3==t.index},on:{click:function(a){t.changeTabbarFn(3)}}},[e("span",[t._v("点击榜")])])]),t._v(" "),e("div",{ref:"wrapper",staticClass:"book-container"},[e("div",{staticClass:"wrapper"},[t._l(t.bookData,function(a,n){return[a.book_id?e("book-info",{key:n,attrs:{tag:n+1+"",book:a}}):t._e()]}),t._v(" "),e("div",{staticClass:"bottom-top"},[t.pullingUpStart?e("loading"):t._e(),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.pullingUpStart&&t.isHaveData,expression:"!pullingUpStart&&isHaveData"}],staticClass:"loading-hook"},[t._v("加载更多")]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.pullingUpStart&&!t.isHaveData,expression:"!pullingUpStart&&!isHaveData"}],staticClass:"loading-hook"},[t._v("没有更多书籍了")])],1)],2)])]):t._e(),t._v(" "),2==t.templet_num?e("div",{staticStyle:{height:"100%"}},[e("div",{staticClass:"rank-tabbar"},[2==t.templet_num?e("div",{staticClass:"cat-info cat-info-sex"},[e("div",{staticClass:"tabbar-wrap-sex"},[e("div",{staticClass:"tabbar-item",class:{active:2==t.sex},attrs:{"t-center":""},on:{click:function(a){t.changeSexFn(2)}}},[e("span",[t._v("女生")])]),t._v(" "),e("div",{staticClass:"tabbar-item",class:{active:1==t.sex},attrs:{"t-center":""},on:{click:function(a){t.changeSexFn(1)}}},[e("span",[t._v("男生")])])])]):t._e()]),t._v(" "),e("div",{ref:"wrapper",staticClass:"book-container"},[e("div",{staticClass:"wrapper"},[e("div",{staticClass:"book-rank-top-three"},[t._l(t.topThree,function(a,n){return[a.book_id?e("GoodBooks",{key:n,attrs:{bookType:"rankTopThree",book:a,bookIndex:n}}):t._e()]})],2),t._v(" "),t._l(t.bookData,function(a,n){return[a.book_id?e("GoodBooks",{key:n,attrs:{bookType:"rankBook",book:a,bookIndex:n}}):t._e()]}),t._v(" "),e("div",{staticClass:"bottom-top"},[t.pullingUpStart?e("loading"):t._e(),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.pullingUpStart&&t.isHaveData,expression:"!pullingUpStart&&isHaveData"}],staticClass:"loading-hook"},[t._v("加载更多")]),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.pullingUpStart&&!t.isHaveData,expression:"!pullingUpStart&&!isHaveData"}],staticClass:"loading-hook"},[t._v("没有更多书籍了")])],1)],2)])]):t._e()],1)},staticRenderFns:[]};var _=e("VU/8")(g,f,!1,function(t){e("eDCi")},"data-v-e816253c",null);a.default=_.exports},eDCi:function(t,a){}});