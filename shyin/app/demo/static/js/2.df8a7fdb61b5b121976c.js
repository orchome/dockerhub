webpackJsonp([2],{"80dI":function(t,s,a){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=a("Xxa5"),i=a.n(e),n=a("exGp"),o=a.n(n),r=a("Dd8w"),c=a.n(r),l=a("cS7h"),u=a("688b"),p=a("qERK"),v=a("GQaK"),h=a("+VX7"),f=a("SJI6"),_=a("TIfe"),g={name:"store",components:{Navigation:l.a,BookInfo:u.a,loading:p.a,GoodBooks:h.a},watch:{active:function(t){var s=this;t?this.$refs.fill.style.height=this.$refs.catwrap.clientHeight-this.$refs.catinfo.clientHeight+"px":this.$nextTick(function(){s.$refs.fill.style.height="0px"})}},computed:c()({},Object(f.mapGetters)({sex:"sex",store:"store",storeBooks:"storeBooks",storePagination:"storePagination",templet_num:"templet_num"})),data:function(){return{scroll:"",pullingUpStart:!1,isHaveData:!0,active:!0,state:{category:"全部分类",serial_status:"全部"},params:{category:"0",serial_status:"0"}}},methods:{selectSerialStatusFn:function(t,s){this.params.serial_status=t,this.state.serial_status=s,this.storePagination.current_page=1,this.getIndexBooksFn()},selectFn:function(t,s){this.params.category=t,this.state.category=s,this.storePagination.current_page=1,this.getIndexBooksFn()},getBooksCategory:function(){var t=o()(i.a.mark(function t(){var s=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("getBooksCategory",{sex:this.sex});case 2:this.$nextTick(function(){s.$refs.fill.style.height=s.$refs.catwrap.clientHeight-s.$refs.catinfo.clientHeight+"px"});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getIndexBooksFn:function(){var t=o()(i.a.mark(function t(){var s,a,e=this;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(s=this._.cloneDeep(this.params)).page=this.storePagination.current_page,s.sex=this.sex,t.next=5,this.$store.dispatch("getIndexBooks",s);case 5:a=t.sent,this.pullingUpStart=!1,this.$nextTick(function(){200==a.code&&(1==a.pagination.current_page&&e.scroll&&e.scroll.scrollTo(0,0,200,"bounce"),a.pagination.current_page>=a.pagination.total_pages?(e.isHaveData=!1,e.scroll&&(e.scroll.closePullUp(),e.scroll.refresh())):(e.isHaveData=!0,e.scroll&&(e.scroll.finishPullUp(),e.scroll.refresh())))});case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),initBScroll:function(){var t=this;""==this.scroll?this.$nextTick(function(){t.scroll=new v.a(t.$refs.wrapper,{click:!0,pullUpLoad:{threshold:0}}),t.scroll.on("pullingUp",function(){t.isHaveData&&(t.pullingUpStart=!0,t.getIndexBooksFn())})}):this.scroll.refresh()},changeTabbarFn:function(t){this.$store.dispatch("getSexAction",t),Object(_.i)(t),this.storePagination.current_page=1,this.params.category="",this.active=!0,this.getBooksCategory(),this.getIndexBooksFn()}},created:function(){this.$route.params.catid&&(this.params.category=this.$route.params.catid+""),this.getBooksCategory(),this.getIndexBooksFn()},mounted:function(){this.initBScroll()},beforeDestroy:function(){this.scroll&&this.scroll.destroy()}},d={render:function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{class:[1==t.sex?"boy":"girl",2==t.templet_num?"store-module2":"store"]},[a("navigation",[t._v("书库")]),t._v(" "),2==t.templet_num?a("div",{staticClass:"cat-info cat-info-sex"},[a("div",{staticClass:"tabbar-wrap-sex"},[a("div",{staticClass:"tabbar-item",class:{active:2==t.sex},attrs:{"t-center":""},on:{click:function(s){t.changeTabbarFn(2)}}},[a("span",[t._v("女生")])]),t._v(" "),a("div",{staticClass:"tabbar-item",class:{active:1==t.sex},attrs:{"t-center":""},on:{click:function(s){t.changeTabbarFn(1)}}},[a("span",[t._v("男生")])])])]):t._e(),t._v(" "),a("div",{staticClass:"cat-container",class:{active:t.active}},[a("div",{ref:"catinfo",staticClass:"cat-info cat-info-category",on:{click:function(s){t.active=!0}}},[a("span",[t._v(t._s(t.state.category))]),t._v(" "),a("span",{staticClass:"cat-info-dot"}),t._v(" "),a("span",[t._v(t._s(t.state.serial_status))]),t._v(" "),a("span")]),t._v(" "),a("div",{ref:"catwrap",staticClass:"cat-wrap"},[a("ul",{staticClass:"cat list"},[a("li",{class:{active:0==t.params.category},on:{click:function(s){t.selectFn("0","全部分类")}}},[t._v("全部分类")]),t._v(" "),t._l(t.store,function(s){return a("li",{key:s.id,class:{active:t.params.category==s.id},on:{click:function(a){t.selectFn(s.id,s.cat_name)}}},[t._v(t._s(s.cat_name))])})],2),t._v(" "),a("ul",{staticClass:"serial list"},[a("li",{class:{active:0==t.params.serial_status},on:{click:function(s){t.selectSerialStatusFn(0,"全部")}}},[t._v("全部")]),t._v(" "),a("li",{class:{active:1==t.params.serial_status},on:{click:function(s){t.selectSerialStatusFn(1,"连载")}}},[t._v("连载")]),t._v(" "),a("li",{class:{active:3==t.params.serial_status},on:{click:function(s){t.selectSerialStatusFn(3,"已完本")}}},[t._v("已完本")])])]),t._v(" "),a("div",{staticClass:"mask",on:{touchstart:function(s){t.active=!1}}})]),t._v(" "),a("div",{staticClass:"book-container"},[a("div",{ref:"fill",staticClass:"fill"}),t._v(" "),a("div",{ref:"wrapper",staticClass:"wrapper"},[a("div",[1==t.templet_num?a("div",[t._l(t.storeBooks,function(s){return[s.book_id?a("book-info",{key:s.book_id,attrs:{book:s}}):t._e()]})],2):t._e(),t._v(" "),2==t.templet_num?a("div",[t._l(t.storeBooks,function(s){return[s.book_id?a("GoodBooks",{key:s.book_id,attrs:{bookType:"goodBook",book:s}}):t._e()]})],2):t._e(),t._v(" "),a("div",{staticClass:"bottom-top"},[t.pullingUpStart?a("loading"):t._e(),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.pullingUpStart&&t.isHaveData,expression:"!pullingUpStart&&isHaveData"}],staticClass:"loading-hook"},[t._v("加载更多")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.pullingUpStart&&!t.isHaveData,expression:"!pullingUpStart&&!isHaveData"}],staticClass:"loading-hook"},[t._v("没有更多书籍了")])],1)])])])],1)},staticRenderFns:[]};var k=a("VU/8")(g,d,!1,function(t){a("zS1B")},null,null);s.default=k.exports},zS1B:function(t,s){}});