webpackJsonp([180],{Q58D:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("Xxa5"),i=e.n(o),a=e("exGp"),s=e.n(a),r=e("RRo+"),l=e.n(r),c=e("Dd8w"),d=e.n(c),u=e("NYxO"),p={name:"operationBookshelf",components:{GetAllBooks:e("qcO4").a},computed:d()({},Object(u.b)({operationBookbsList:"operationBookbsList",allBook:"allBook"}),{dialogTitle:function(){return"add"==this.dialogType?"新增书单书籍":"编辑书单书籍"}}),watch:{},data:function(){return{rules:{sort:[{validator:function(n,t,e){t||t+""=="0"||e(new Error("序号不能为空")),setTimeout(function(){l()(Number(t))?e():e(new Error("请输入数字值"))},1e3)},trigger:"blur"}]},dialogType:"add",dialogFormVisible:!1,bookname:"",form:{sex:"1",sort:"",book_id:"",position:"2"},loading:!1,params:{page:1},size:20}},created:function(){this.$store.dispatch("getAjaxGetBook"),this.getBackbsListFn()},methods:{addFn:function(){this.dialogType="add",this.form={sex:"1",sort:"",book_id:"",position:"2"},this.dialogFormVisible=!0},editFn:function(n){var t=n.book_id,e=n.book,o=void 0===e?{}:e,i=n.sex,a=n.sort,s=n.position,r=n.id;this.form={id:r,sex:i+"",sort:a+"",book_id:t+"",position:s+""},this.bookname=o.name,this.dialogType="edit",this.dialogFormVisible=!0},submitForm:function(n){var t=this,e=this,o=this.dialogTitle;this.$refs[n].validate(function(n){if(!n)return console.log("error submit!!"),!1;if(""==t.form.book_id)t.$message({duration:1500,message:"请选择小说",type:"warning"});else{var i=e._.cloneDeep(e.form);"新增书单书籍"==o?e.putBackbsCreate(i):e.editBackbsCreate(i)}})},editBackbsCreate:function(){var n=s()(i.a.mark(function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("editBackbsCreate",t);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"编辑成功~",type:"success"}),this.form={sex:"1",sort:"",book_id:"",position:"2"},this.getBackbsListFn(),this.goBackFn());case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),putBackbsCreate:function(){var n=s()(i.a.mark(function n(t){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("putBackbsCreate",t);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"添加成功~",type:"success"}),this.form={sex:"1",sort:"",book_id:"",position:"2"},this.getBackbsListFn(),this.goBackFn());case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),resetForm:function(n){this.$refs[n].resetFields()},goBackFn:function(){this.resetForm("ruleForm"),this.dialogFormVisible=!1},deleteBackbsDelFn:function(){var n=s()(i.a.mark(function n(t){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("deleteBackbsDel",{id:t});case 2:200==n.sent.code&&(this.$message({duration:1500,message:"删除成功！",type:"success"}),this.getBackbsListFn());case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),getBackbsListFn:function(){var n=s()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.loading=!0,n.next=3,this.$store.dispatch("getBackbsList",this.params);case 3:this.loading=!1;case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),handleCurrentChange:function(n){this.params.page=n,this.getBackbsListFn()},fuzzyQueryFn:function(){this.params.page=1,this.getBackbsListFn()}}},f={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container accounts-container"},[e("div",{staticClass:"bar clearfix"},[e("div",{staticClass:"float-right"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:n.addFn}},[n._v("新增")])],1)]),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:n.operationBookbsList.data,border:"",stripe:""}},[e("el-table-column",{attrs:{prop:"id",label:"序号","min-width":"80",fixed:"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"book_id",label:"书籍ID","min-width":"150","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"name",label:"书籍名称","min-width":"120",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"sort",label:"排序","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"sex",label:"书架性别","min-width":"120","show-overflow-tooltip":"",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[1==t.row.sex?e("el-tag",[n._v("男频书单")]):2==t.row.sex?e("el-tag",{attrs:{type:"danger"}},[n._v("女频书单")]):e("span",[n._v("-")])]}}])}),n._v(" "),e("el-table-column",{attrs:{prop:"place",label:"书架位置","min-width":"120","show-overflow-tooltip":"",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[1==t.row.position?e("span",[n._v("书架中")]):2==t.row.position?e("span",{attrs:{type:"danger"}},[n._v("书架banner")]):e("span",[n._v("-")])]}}])}),n._v(" "),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){n.editFn(t.row)}}},[n._v("编辑")]),n._v(" "),e("el-popover",{attrs:{placement:"top",width:"100"},model:{value:t.row.delete,callback:function(e){n.$set(t.row,"delete",e)},expression:"scope.row.delete"}},[e("p",[n._v("确认删除选择的书籍？")]),n._v(" "),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){t.row.delete=!1}}},[n._v("取消")]),n._v(" "),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){n.deleteBackbsDelFn(t.row.id),t.row.delete=!1}}},[n._v("确定")])],1),n._v(" "),e("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(n){t.row.delete=!0}},slot:"reference"},[n._v("删除")])],1)]}}])})],1),n._v(" "),e("div",{staticClass:"pagination-container clearfix"},[e("div",{staticClass:"float-left"},[e("global-pagination",{attrs:{"current-page":n.params.page,"page-size":n.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:n.operationBookbsList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1)]),n._v(" "),e("el-dialog",{attrs:{title:n.dialogTitle,visible:n.dialogFormVisible},on:{"update:visible":function(t){n.dialogFormVisible=t}}},[e("el-form",{ref:"ruleForm",attrs:{model:n.form,"label-width":"120px",rules:n.rules}},[e("el-form-item",{attrs:{label:"书架性别"}},[e("el-radio-group",{model:{value:n.form.sex,callback:function(t){n.$set(n.form,"sex",t)},expression:"form.sex"}},[e("el-radio",{attrs:{label:"1"}},[n._v("男")]),n._v(" "),e("el-radio",{attrs:{label:"2"}},[n._v("女")])],1)],1),n._v(" "),e("el-form-item",{attrs:{label:"书架位置"}},[e("el-radio-group",{model:{value:n.form.position,callback:function(t){n.$set(n.form,"position",t)},expression:"form.position"}},[e("el-radio",{attrs:{label:"2"}},[n._v("书架banner")]),n._v(" "),e("el-radio",{attrs:{label:"1"}},[n._v("书架中")])],1)],1),n._v(" "),e("el-form-item",{attrs:{label:"书籍id"}},[e("get-all-books",{attrs:{visible:n.dialogFormVisible,"book-list":n.allBook,bookid:n.form.book_id,bookname:n.bookname,placeholder:"请输入书籍id或名称搜索"},on:{"update:bookid":function(t){n.$set(n.form,"book_id",t)}}})],1),n._v(" "),e("el-form-item",{attrs:{label:"排序",prop:"sort"}},[e("el-input",{attrs:{autocomplete:"off",placeholder:"请输入序号"},model:{value:n.form.sort,callback:function(t){n.$set(n.form,"sort",t)},expression:"form.sort"}})],1)],1),n._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:n.goBackFn}},[n._v("取消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:function(t){n.submitForm("ruleForm")}}},[n._v("提交")])],1)],1)],1)},staticRenderFns:[]};var m=e("VU/8")(p,f,!1,function(n){e("oPxa")},null,null);t.default=m.exports},Sa1e:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},oPxa:function(n,t,e){var o=e("Sa1e");"string"==typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);e("rjj0")("0a737457",o,!0)}});