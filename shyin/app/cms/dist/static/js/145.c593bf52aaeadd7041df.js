webpackJsonp([145],{EPmw:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("lHA8"),a=t.n(i),o=t("c/Tr"),r=t.n(o),s=t("Xxa5"),l=t.n(s),c=t("exGp"),d=t.n(c),p=t("Dd8w"),u=t.n(p),h=t("NYxO"),m={name:"CPSSearchList",computed:u()({},Object(h.b)({cpsSearchList:"cpsSearchList"}),{multipleDeleteVisible:function(){return 0===this.multipleSelect.length}}),watch:{dialogFormVisible:function(n){n||("add"==this.dialogType?this.form.book_id=[]:this.form.book_id="",this.options=[],this.resetForm("ruleForm"))}},data:function(){return{dialogType:"add",options:[],bookList:[],selectLoading:!1,dialogTitle:"添加搜索书籍",dialogFormVisible:!1,form:{id:"",book_id:[],sex:"1"},multipleSelect:[],multipleDelete:!1,data:[{id:1}],loading:!1,sendType:[{id:"1",name:"男频"},{id:"2",name:"女频"}],params:{page:1,sex:"1"}}},created:function(){this.getAjaxGetBookFn(),this.getCPSSearchListFn()},methods:{multipleDeleteFn:function(n){if("0"==n)this.multipleDelete=!1;else{var e=[];this.multipleSelect.forEach(function(n){e.push(n.id)}),e=e.toString(),this.deleteCPSSearchDel(e),this.multipleDelete=!1}},addFn:function(){this.dialogType="add",this.form.book_id=[],this.dialogTitle="添加搜索书籍",this.form.id="",this.dialogFormVisible=!0},remoteMethod:function(n){var e=this;""!==n?(this.selectLoading=!0,setTimeout(function(){e.selectLoading=!1,e.options=e.bookList.filter(function(e){return e.id.indexOf(n)>-1||e.name.indexOf(n)>-1})},200)):this.options=[]},getAjaxGetBookFn:function(){var n=d()(l.a.mark(function n(){var e;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSBook");case 2:200==(e=n.sent).code&&(e.data.forEach(function(n){return n.id=n.id+""}),this.bookList=e.data);case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),editFn:function(){var n=d()(l.a.mark(function n(e){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.dialogType="edit",this.dialogTitle="编辑搜索书籍",this.form={id:e.id+"",book_id:e.book_id+"",sex:e.sex},this.options=[{id:e.book_id+"",name:e.book_name}],this.dialogFormVisible=!0;case 5:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),handleSelectionChange:function(n){this.multipleSelect=n},resetForm:function(n){this.$refs[n].resetFields()},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return console.log("error submit!!"),!1;var t=e._.cloneDeep(e.form);"add"==e.dialogType?(t.book_id=r()(new a.a(t.book_id)).toString(),t.sex=e.params.sex,e.postCPSSearchCreateFn(t)):e.postCPSSearchUpdateFn(t)})},handleCurrentChange:function(n){this.params.page=n,this.getCPSSearchListFn()},postCPSSearchCreateFn:function(){var n=d()(l.a.mark(function n(e){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postCPSSearchCreate",e);case 2:200==n.sent.code&&this.successMsgFn("添加成功~"),this.dialogFormVisible=!1,this.getCPSSearchListFn();case 6:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),postCPSSearchUpdateFn:function(){var n=d()(l.a.mark(function n(e){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postCPSSearchUpdate",e);case 2:200==n.sent.code&&this.successMsgFn("修改成功~"),this.dialogFormVisible=!1,this.getCPSSearchListFn();case 6:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),getCPSSearchListFn:function(){var n=d()(l.a.mark(function n(){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.loading=!0,n.next=3,this.$store.dispatch("getCPSSearchList",this.params);case 3:this.loading=!1;case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),deleteCPSSearchDel:function(){var n=d()(l.a.mark(function n(e){return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("deleteCPSSearchDel",{id:e});case 2:200==n.sent.code&&(this.successMsgFn("删除成功~"),this.getCPSSearchListFn());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}},f={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("el-tabs",{on:{"tab-click":function(e){n.getCPSSearchListFn()}},model:{value:n.params.sex,callback:function(e){n.$set(n.params,"sex",e)},expression:"params.sex"}},[t("el-tab-pane",{attrs:{label:"男频",name:"1"}}),n._v(" "),t("el-tab-pane",{attrs:{label:"女频",name:"2"}})],1),n._v(" "),t("div",{staticClass:"bar clearfix"},[t("div",{staticClass:"float-right"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:n.addFn}},[n._v("新增")])],1)]),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:n.cpsSearchList.data,border:"",stripe:""},on:{"selection-change":n.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),n._v(" "),t("el-table-column",{attrs:{prop:"id",label:"序号","min-width":"80",fixed:""}}),n._v(" "),t("el-table-column",{attrs:{prop:"book_id",label:"书籍ID","min-width":"150","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"book_name",label:"书籍名称","min-width":"120"}}),n._v(" "),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"120","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){n.editFn(e.row)}}},[n._v("编辑")]),n._v(" "),t("el-popover",{attrs:{placement:"top",width:"100"},model:{value:e.row.delete,callback:function(t){n.$set(e.row,"delete",t)},expression:"scope.row.delete"}},[t("p",[n._v("确认删除选择的内容？")]),n._v(" "),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){e.row.delete=!1}}},[n._v("取消")]),n._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){n.deleteCPSSearchDel(e.row.id),e.row.delete=!1}}},[n._v("确定")])],1),n._v(" "),t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(n){e.row.delete=!0}},slot:"reference"},[n._v("删除")])],1)]}}])})],1),n._v(" "),t("div",{staticClass:"pagination-container clearfix"},[t("div",{staticClass:"float-left mr-30"},[t("el-popover",{attrs:{placement:"top",width:"100"},model:{value:n.multipleDelete,callback:function(e){n.multipleDelete=e},expression:"multipleDelete"}},[t("p",[n._v("确认删除选择的内容？")]),n._v(" "),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){n.multipleDeleteFn("0")}}},[n._v("取消")]),n._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){n.multipleDeleteFn("1")}}},[n._v("确定")])],1),n._v(" "),t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",disabled:n.multipleDeleteVisible},on:{click:function(e){n.multipleDelete=!0}},slot:"reference"},[n._v("删除")])],1)],1),n._v(" "),t("div",{staticClass:"float-left"},[t("global-pagination",{attrs:{"current-page":n.params.page,"page-size":n.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:n.cpsSearchList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1)]),n._v(" "),t("el-dialog",{staticClass:"search-dialog",attrs:{title:n.dialogTitle,visible:n.dialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){n.dialogFormVisible=e}}},[t("el-form",{ref:"ruleForm",attrs:{model:n.form,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"书籍名称",prop:"add"==n.dialogType?"book_id":"",rules:"add"==n.dialogType?[{type:"array",required:!0,message:"请至少选择一本小说",trigger:"change"}]:""}},[t("el-select",{staticStyle:{width:"100%"},attrs:{"reserve-keyword":"",placeholder:"请输入书籍名称",filterable:"",remote:"","remote-method":n.remoteMethod,loading:n.selectLoading,multiple:"add"==n.dialogType},model:{value:n.form.book_id,callback:function(e){n.$set(n.form,"book_id",e)},expression:"form.book_id"}},n._l(n.options,function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}},[t("span",{staticStyle:{float:"left"}},[n._v(n._s(e.id))]),n._v(" "),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[n._v(n._s(e.name))])])}))],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){n.dialogFormVisible=!1}}},[n._v("取 消")]),n._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("ruleForm")}}},[n._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var g=t("VU/8")(m,f,!1,function(n){t("qx5E")},null,null);e.default=g.exports},Jwdl:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},qx5E:function(n,e,t){var i=t("Jwdl");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("rjj0")("00619569",i,!0)}});