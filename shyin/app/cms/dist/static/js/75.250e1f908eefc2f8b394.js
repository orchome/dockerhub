webpackJsonp([75],{M8pr:function(e,t,n){var i=n("g/WL");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("53abfe20",i,!0)},XLQ4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Xxa5"),o=n.n(i),a=n("exGp"),l=n.n(a),r=n("Dd8w"),s=n.n(r),c=n("NYxO"),p=n("msXN"),u={name:"operationComment1",components:{Upload:n("TAej").a},mixins:[p.a],computed:s()({},Object(c.b)({operationCommentList:"operationCommentList",operationcommentKeywords:"operationcommentKeywords"}),{multipleDeleteVisible:function(){return 0==this.multipleSelect.length&&(this.multipleDelete=!1),0===this.multipleSelect.length},cannotDeleteUserId:function(){return this.userid&&0==this.userid.length||0==this.operationCommentList.data.length}}),watch:{params:{handler:function(e){""==e.userid&&(this.userid="")},deep:!0}},data:function(){return{visible:!1,loading:!1,userid:"",params:{userid:"",page:1,book:"",key_word:[]},size:20,multipleSelect:[],multipleDelete:!1}},created:function(){this.getCommentListFn(),this.params.key_word=this.operationcommentKeywords.map(function(e){return e.name})},methods:{closedFn:function(){},templateDownloadFn:function(){this.download("/admin/comment_template")},deleteAllUserIdFn:function(){var e=this;/(^[1-9]\d*$)/.test(this.userid)?this.$confirm("此操作将永久删除该用户的评论, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.deleteCommentDelFn(e.userid,"userid")}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):this.$message({duration:1500,message:"请输入正确的用户ID",type:"warning"})},deleteCommentDelFn:function(){var e=l()(o.a.mark(function e(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n={})[i]=t,e.next=4,this.$store.dispatch("deleteCommentDel",n);case 4:200==e.sent.code&&(this.$message({duration:1500,message:"删除成功！",type:"success"}),this.getCommentListFn());case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getCommentListFn:function(){var e=l()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$store.dispatch("getCommentList",this.params);case 3:this.loading=!1;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleSelectionChange:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),this.multipleSelect=t},multipleDeleteFn:function(){var e=this.multipleSelect.toString();this.deleteCommentDelFn(e)},handleCurrentChange:function(e){this.params.page=e,this.getCommentListFn()},fuzzyQueryFn:function(){this.params.page=1,this.userid=this.params.userid,this.getCommentListFn()},editKeywords:function(){this.$router.push({path:"/operationManage/comment/editKeywords"})},closeKeyword:function(e){var t=this.operationcommentKeywords;t.splice(e,1),this.$store.commit("Set_Comment_Active_Keywords",t),this.params.key_word=this.operationcommentKeywords.map(function(e){return e.name})}}},m={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"keywords-box"},e._l(e.params.key_word,function(t,i){return n("el-tag",{key:i,staticStyle:{"margin-right":"10px"},attrs:{closable:""},on:{close:function(t){e.closeKeyword(i)}}},[e._v("\n      "+e._s(t)+"\n    ")])})),e._v(" "),n("div",{staticClass:"bar flex"},[n("div",{staticClass:"flex-left"},[n("label",{staticClass:"radio-label",staticStyle:{"padding-left":"0"}},[e._v("小说名称")]),e._v(" "),n("el-input",{staticStyle:{width:"170px"},attrs:{placeholder:"请输入小说名称"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.fuzzyQueryFn(t)}},model:{value:e.params.book,callback:function(t){e.$set(e.params,"book","string"==typeof t?t.trim():t)},expression:"params.book"}}),e._v(" "),n("label",{staticClass:"radio-label"},[e._v("用户ID")]),e._v(" "),n("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入用户ID"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.fuzzyQueryFn(t)}},model:{value:e.params.userid,callback:function(t){e.$set(e.params,"userid","string"==typeof t?t.trim():t)},expression:"params.userid"}})],1),e._v(" "),n("div",{staticClass:"flex-right"},[n("el-button",{staticClass:"search",attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.fuzzyQueryFn}},[e._v("搜索")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-upload2",size:"mini"},on:{click:function(t){e.visible=!0}}},[e._v("导入评论")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:e.templateDownloadFn}},[e._v("模板下载")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-delete",size:"mini",disabled:e.cannotDeleteUserId},on:{click:e.deleteAllUserIdFn}},[e._v("删除用户ID所有评论")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.editKeywords}},[e._v("编辑关键词")])],1)]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.operationCommentList.data,border:"",stripe:"",multipleTable:""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"user_id",label:"用户ID","min-width":"150","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"nickname",label:"用户昵称","min-width":"120",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"book_id",label:"小说ID","min-width":"120","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"bookname",label:"小说名称","min-width":"120","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"content",label:"评论内容","min-width":"120","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"120","show-overflow-tooltip":"",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{placement:"top",width:"100"},model:{value:t.row.delete,callback:function(n){e.$set(t.row,"delete",n)},expression:"scope.row.delete"}},[n("p",[e._v("确认删除选择的评论？")]),e._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.delete=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){e.deleteCommentDelFn(t.row.id),t.row.delete=!1}}},[e._v("确定")])],1),e._v(" "),n("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(e){t.row.delete=!0}},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),n("div",{staticClass:"pagination-container clearfix"},[n("div",{staticClass:"float-left mr-30"},[n("el-popover",{attrs:{placement:"top",width:"100"},model:{value:e.multipleDelete,callback:function(t){e.multipleDelete=t},expression:"multipleDelete"}},[n("p",[e._v("确认删除选择的评论？")]),e._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.multipleDelete=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.multipleDeleteFn(),e.multipleDelete=!1}}},[e._v("确定")])],1),e._v(" "),n("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",disabled:e.multipleDeleteVisible},on:{click:function(t){e.multipleDelete=!0}},slot:"reference"},[e._v("删除")])],1)],1),e._v(" "),n("div",{staticClass:"float-left"},[n("global-pagination",{attrs:{"current-page":e.params.page,"page-size":e.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:e.operationCommentList.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)]),e._v(" "),n("upload",{attrs:{download:!1,action:"/admin/comment_import",visible:e.visible},on:{"update:visible":function(t){e.visible=t},success:function(t){e.params.page=1,e.getCommentListFn()}}},[e._v("仅允许上传xls结尾的文件")])],1)},staticRenderFns:[]};var d=n("VU/8")(u,m,!1,function(e){n("M8pr")},null,null);t.default=d.exports},"g/WL":function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,"\n.keywords-box{\r\n  min-height: 25px;\r\n  /* background: red; */\r\n  margin-bottom:10px;\r\n  padding: 5px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  background-color: #fafafa;\n}\n.keywords-box-des{\r\n  color: #999;\r\n  text-align: center;\r\n  font-size: 12px;\r\n  line-height: 2;\n}\r\n",""])}});