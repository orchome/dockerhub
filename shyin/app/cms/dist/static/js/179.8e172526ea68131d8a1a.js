webpackJsonp([179],{"7evO":function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("Xxa5"),i=e.n(a),o=e("exGp"),s=e.n(o),l=e("Dd8w"),c=e.n(l),r=e("NYxO"),d=e("0xDb"),u=e("TAej"),p={computed:c()({},Object(r.b)({cmBookList:"cmBookList"})),watch:{},components:{Upload:u.a},data:function(){return{loading:!1,dialog:{book_name:"",show:!1},upload:{visible:!1,data:{channel_id:""}},params:{page:1},query:{cat_id:"",id:""}}},created:function(){var n=this.$route.params.id;this.upload.data.channel_id=n,this.$route.query&&(this.query={cat_id:this.$route.query.cat_id,id:this.$route.query.id},this.upload.data.cat_id=this.$route.query.id)},mounted:function(){this.getTableData()},methods:{getTableData:function(){var n=this;return s()(i.a.mark(function t(){var e,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=n._.cloneDeep(n.params),a=n.$route.params.id,e.cat_id=n.query.cat_id,e.id=a,n.loading=!0,n.$store.dispatch("cmBookList",e).then(function(){n.loading=!1});case 6:case"end":return t.stop()}},t,n)}))()},handleCurrentChange:function(n){this.params.page=n,this.getTableData()},submitAddBook:function(){var n=this,t={channel:this.$route.params.id,books:this.dialog.book_name};this.$route.query&&(t.cat_id=this.$route.query.id),this.$store.dispatch("cmAddBook",t).then(function(t){200==t.code&&(Object(d.i)("添加成功","success"),setTimeout(function(){n.dialog.show=!1,n.dialog.book_name="",n.getTableData()},1e3))})},closedFn:function(){this.upload.visible=!1},upSuccess:function(){this.getTableData()},deleteItem:function(n){var t=this;this.$store.dispatch("cmDeleteBook",{id:n}).then(function(n){200==n.code&&(Object(d.i)("删除成功","success"),setTimeout(function(){t.getTableData()},1e3))})}}},h={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"bar clearfix"},[e("div",{staticClass:"float-right"},[e("el-button",{staticClass:"search",attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){n.dialog.show=!0}}},[n._v("新增")]),n._v(" "),e("el-button",{staticClass:"search",attrs:{type:"primary",size:"mini",icon:"el-icon-upload"},on:{click:function(t){n.upload.visible=!0}}},[n._v("导入书籍")])],1)]),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:n.cmBookList.data,border:"",stripe:""}},[e("el-table-column",{attrs:{prop:"book_id",label:"书籍ID","min-width":"80",fixed:"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"book_name",label:"书籍名称","min-width":"150","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"cat_name",label:"所属分类","min-width":"120",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){n.deleteItem(t.row.id)}}},[n._v("删除")])]}}])})],1),n._v(" "),e("div",{staticClass:"pagination-container clearfix"},[e("global-pagination",{attrs:{background:"","current-page":n.params.page,"page-size":n.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:n.cmBookList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1),n._v(" "),e("el-dialog",{staticClass:"dialog-500",attrs:{title:"添加书籍",visible:n.dialog.show,top:"15%"},on:{"update:visible":function(t){n.$set(n.dialog,"show",t)}}},[e("el-form",{staticStyle:{width:"400px"}},[e("el-form-item",{attrs:{label:"书籍ID:","label-width":"120px"}},[e("el-input",{attrs:{placeholder:"多个书籍ID可用英文逗号隔开"},model:{value:n.dialog.book_name,callback:function(t){n.$set(n.dialog,"book_name",t)},expression:"dialog.book_name"}})],1)],1),n._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){n.dialog.show=!1}}},[n._v("取 消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.submitAddBook}},[n._v("确 定")])],1)],1),n._v(" "),e("upload",{attrs:{name:"book",data:n.upload.data,action:"/admin/channel_book_import",visible:n.upload.visible,template:"channelBus_import_book.xls"},on:{closed:n.closedFn,"update:visible":function(t){n.$set(n.upload,"visible",t)},success:n.upSuccess}},[n._v("仅允许上传xls结尾的文件")])],1)},staticRenderFns:[]};var m=e("VU/8")(p,h,!1,function(n){e("JtJB")},null,null);t.default=m.exports},"8Q7h":function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},JtJB:function(n,t,e){var a=e("8Q7h");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("771eacc3",a,!0)}});