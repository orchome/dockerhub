webpackJsonp([86],{"+q7U":function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("Xxa5"),i=t.n(o),l=t("exGp"),a=t.n(l),r=t("RRo+"),s=t.n(r),c=t("Dd8w"),p=t.n(c),u=t("NYxO"),d={components:{GetAllBooks:t("qcO4").a},computed:p()({},Object(u.b)({operationHomeTemplateBookList:"operationHomeTemplateBookList",allBook:"allBook"}),{multipleDeleteVisible:function(){return 0==this.multipleSelect.length&&(this.multipleDelete=!1),0===this.multipleSelect.length},dialogTitle:function(){return"add"==this.dialogType?"添加书籍":"编辑书籍"}}),watch:{},data:function(){return{rules:{sort:[{validator:function(n,e,t){e||e+""=="0"||t(new Error("序号不能为空")),setTimeout(function(){s()(Number(e))?t():t(new Error("请输入数字值"))},1e3)},trigger:"blur"}]},dialogType:"add",dialogFormVisible:!1,form:{id:"",sort:"",book_id:""},loading:!1,params:{page:1,id:""},size:20,multipleSelect:[],multipleDelete:!1,bookname:""}},created:function(){this.$store.dispatch("getAjaxGetBook"),this.params.id=this.$route.params.id,this.getTemplateBookListFn()},methods:{addFn:function(){this.dialogType="add",this.form={id:"",sort:"",book_id:"",template_id:this.$route.params.id},this.dialogFormVisible=!0},editFn:function(n){this.dialogType="edit",this.form={id:n.id,sort:n.sort,book_id:n.book_id,template_id:n.template_id},this.bookname=n.name,this.dialogFormVisible=!0},submitForm:function(n){var e=this,t=this;this.$refs[n].validate(function(n){if(!n)return console.log("error submit!!"),!1;if(""==e.form.book_id)e.$message({duration:1500,message:"请选择小说",type:"warning"});else{var o=t._.cloneDeep(t.form);"add"==t.dialogType?(delete o.id,e.putTemplateBookAddFn(o)):e.putTemplateBookUpdateFn(o)}})},putTemplateBookAddFn:function(){var n=a()(i.a.mark(function n(e){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("putTemplateBookAdd",e);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"添加成功",type:"success"}),this.goBackFn(),this.getTemplateBookListFn());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),putTemplateBookUpdateFn:function(){var n=a()(i.a.mark(function n(e){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("putTemplateBookUpdate",e);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"修改成功",type:"success"}),this.goBackFn(),this.getTemplateBookListFn());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),resetForm:function(n){this.$refs[n].resetFields()},goBackFn:function(){this.resetForm("ruleForm"),this.dialogFormVisible=!1},getTemplateBookListFn:function(){var n=a()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this.loading=!0,n.next=3,this.$store.dispatch("getTemplateBookList",this.params);case 3:this.loading=!1;case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),handleSelectionChange:function(n){var e=[];n.forEach(function(n){e.push(n.id)}),this.multipleSelect=e},multipleDeleteFn:function(){var n=this.multipleSelect.toString();this.deleteTemplateBookDelFn(n)},deleteTemplateBookDelFn:function(){var n=a()(i.a.mark(function n(e){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("deleteTemplateBookDel",{id:e});case 2:200==n.sent.code&&(this.$message({duration:1500,message:"删除成功！",type:"success"}),this.getTemplateBookListFn());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),handleCurrentChange:function(n){this.params.page=n,this.getTemplateBookListFn()}}},m={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container accounts-container"},[t("div",{staticClass:"bar clearfix"},[t("div",{staticClass:"float-right"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:n.addFn}},[n._v("新增")])],1)]),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:n.operationHomeTemplateBookList.data,border:"",stripe:"",multipleTable:""},on:{"selection-change":n.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",width:"55"}}),n._v(" "),t("el-table-column",{attrs:{prop:"id",label:"序号","min-width":"80",fixed:""}}),n._v(" "),t("el-table-column",{attrs:{prop:"template_name",label:"模板名称","min-width":"150","show-overflow-tooltip":"",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"book_id",label:"小说ID","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"name",label:"小说名称","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"sort",label:"排序","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){n.editFn(e.row)}}},[n._v("编辑")]),n._v(" "),t("el-popover",{attrs:{placement:"top",width:"100"},model:{value:e.row.delete,callback:function(t){n.$set(e.row,"delete",t)},expression:"scope.row.delete"}},[t("p",[n._v("确认删除选择的书籍？")]),n._v(" "),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){e.row.delete=!1}}},[n._v("取消")]),n._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){n.deleteTemplateBookDelFn(e.row.id),e.row.delete=!1}}},[n._v("确定")])],1),n._v(" "),t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(n){e.row.delete=!0}},slot:"reference"},[n._v("删除")])],1)]}}])})],1),n._v(" "),t("div",{staticClass:"pagination-container clearfix"},[t("div",{staticClass:"float-left mr-30"},[t("el-popover",{attrs:{placement:"top",width:"100"},model:{value:n.multipleDelete,callback:function(e){n.multipleDelete=e},expression:"multipleDelete"}},[t("p",[n._v("确认删除选择的书籍？")]),n._v(" "),t("div",{staticStyle:{"text-align":"right",margin:"0"}},[t("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){n.multipleDelete=!1}}},[n._v("取消")]),n._v(" "),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){n.multipleDeleteFn(),n.multipleDelete=!1}}},[n._v("确定")])],1),n._v(" "),t("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",disabled:n.multipleDeleteVisible},on:{click:function(e){n.multipleDelete=!0}},slot:"reference"},[n._v("删除")])],1)],1),n._v(" "),t("div",{staticClass:"float-left"},[t("global-pagination",{attrs:{"current-page":n.params.page,"page-size":n.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:n.operationHomeTemplateBookList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1)]),n._v(" "),t("el-dialog",{attrs:{title:n.dialogTitle,visible:n.dialogFormVisible},on:{"update:visible":function(e){n.dialogFormVisible=e}}},[t("el-form",{ref:"ruleForm",attrs:{model:n.form,"label-width":"120px",rules:n.rules}},[t("el-form-item",{attrs:{label:"小说名称"}},[t("get-all-books",{attrs:{visible:n.dialogFormVisible,"book-list":n.allBook,bookid:n.form.book_id,bookname:n.bookname},on:{"update:bookid":function(e){n.$set(n.form,"book_id",e)}}})],1),n._v(" "),t("el-form-item",{attrs:{label:"排序",prop:"sort"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入序号"},model:{value:n.form.sort,callback:function(e){n.$set(n.form,"sort",e)},expression:"form.sort"}})],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:n.goBackFn}},[n._v("取消")]),n._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("ruleForm")}}},[n._v("提交")])],1)],1)],1)},staticRenderFns:[]};var f=t("VU/8")(d,m,!1,function(n){t("Hd4+")},null,null);e.default=f.exports},"Hd4+":function(n,e,t){var o=t("zydR");"string"==typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);t("rjj0")("3b275e60",o,!0)},zydR:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});