webpackJsonp([64],{G2EQ:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},IHqp:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("mvHQ"),a=t.n(r),o=t("Xxa5"),l=t.n(o),s=t("exGp"),i=t.n(s),c=t("Dd8w"),u=t.n(c),p=t("NYxO"),d=t("msXN"),m=t("RRo+"),_=t.n(m),f=t("0xDb"),h=t("Vjby"),v={mixins:[d.a],components:{UrlList:h.a},computed:u()({},Object(p.b)({cpsAccountList:"cpsAccountList",cpsAccountType:"cpsAccountType"})),props:{dialogFormVisible:{type:Boolean,default:!1}},data:function(){var n=function(n,e,t){""===e?"domain"==n.field?t(new Error("请输入B端后台域名")):"transfers_domain"==n.field?t(new Error("请输入中转域名")):"floor_domain"==n.field?t(new Error("请输入落地域名")):t(new Error("请输入域名")):/^(?=^.{3,255}$)[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+$/.test(e)?t():t(new Error("请输入正确的域名"))};return{cleanRuleForm:{},cleanRuleForm2:{},level:"10",ruleForm:{username:"",parent_id:"",is_special:"1",is_real:"1",account_type:"1",commission_ratio:"",access_type:[],product_type:[],is_action_limit:"1",use_type:"",password:"",mobile:"",is_agency:"0",add_agent:"0",account_use:"1",special_agent:"",access_way:"1"},ruleForm2:{username:"",domain:"",backgroundColor:1,backgroundImg:1,api:"",use_common:!0},rules:{parent_id:[{required:!0,validator:function(n,e,t){if(!e&&e+""!="0")return t(new Error("请输入一级代理ID"));setTimeout(function(){_()(Number(e))?t():t(new Error("请输入数字值"))},1e3)},trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],access_type:[{required:!0,type:"array",message:"请选择公众号类型",trigger:"change"}],product_type:[{required:!0,type:"array",message:"请选择产品种类",trigger:"change"}],password:[{required:!0,validator:function(n,e,t){Object(f.a)(e)?t():t(new Error("密码必须为字母加数字且长度不小于8位"))},trigger:"blur"}],mobile:[{required:!0,validator:function(n,e,t){e&&""!==e?/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)?t():t(new Error("请输入正确的11位手机号码")):t(new Error("请输入手机号码"))},trigger:"change"}],commission_ratio:[{required:!0,validator:function(n,e,t){e||e+""=="0"?Number(e)||e+""=="0"?Number(e)>1||Number(e)<0?t(new Error("请输入0-1之间小数的佣金比例")):t():t(new Error("请输入数字值")):t(new Error("佣金比例不能为空"))},trigger:"change"}],special_agent:[{required:!0,message:"请选择特级代理id",trigger:"blur"}]},rules2:{username:[{required:!0,validator:function(n,e,t){if(e&&""!==e){for(var r=0,a=0;a<e.length;a++)e.charCodeAt(a)>127||94==e.charCodeAt(a)?r+=2:r++;r>12?t(new Error("平台名称最大长度12为个字符，汉字及其符号为两个字符")):t()}else t(new Error("请输入平台名称"))},trigger:"blur"}],domain:[{required:!0,validator:n,trigger:"blur"}],transfers_domain:[{required:!0,validator:n,trigger:"blur"}],floor_domain:[{required:!0,validator:n,trigger:"blur"}]},agentLevel:[{id:"0",name:"全部"},{id:"10",name:"特级代理"},{id:"1",name:"一级代理"},{id:"2",name:"二级代理"}],userLevel:[{id:"0",name:"全部"},{id:"10",name:"真实用户"},{id:"1",name:"测试用户"}],searchCondition:"id",keyword:"",condition:[{value:"id",label:"代理ID"},{value:"username",label:"用户名"},{value:"webchat_name",label:"公众号名"},{value:"mobile",label:"手机号"}],params:{level:"0",is_real:"0",page:1,per_page:20},CpsbackgroundImgList:f.l,backgroundColorList:f.m,total:0,data:[{id:"1",name:"2",_book_name:"3",created_at:"4",updated_at:"5"}],userParams:{},allSpecialAgentList:[],allSpecialAgentListCopy:[],oneAgentList:[],newCpsAccountType:{access_type:[],product_type:[]},access_way_type:"1"}},created:function(){this.firstLoad()},activated:function(){this.firstLoad()},methods:{firstLoad:function(){var n=this;this.cleanRuleForm=this._.cloneDeep(this.ruleForm),this.cleanRuleForm2=this._.cloneDeep(this.ruleForm2),this.$store.dispatch("getCPSProductType",{product_type:1}).then(function(e){200==e.code&&(n.newCpsAccountType.access_type=n.cpsAccountType.access_type)}),this.$store.dispatch("getCPSProductType",{product_type:2}).then(function(e){200==e.code&&(n.newCpsAccountType.product_type=n.cpsAccountType.product_type)}),this.getSpecialAgentList()},getSpecialAgentList:function(){var n=this;this.$store.dispatch("getSpecialAgentList").then(function(e){200==e.code&&(e.data.forEach(function(n){n._id="T"+n.id}),n.allSpecialAgentListCopy=n._.cloneDeep(e.data),n.allSpecialAgentList=n._.cloneDeep(e.data))})},changLevelFn:function(n){var e=this;this.resetAllType(),this.$nextTick(function(){e.ruleForm.access_type=[],e.ruleForm.product_type=[],1==n?(e.ruleForm.parent_id="",e.ruleForm.use_type="",e.ruleForm.is_action_limit="1"):2==n&&(e.ruleForm.use_type="1",e.ruleForm.is_action_limit="0"),e.resetForm("ruleForm")})},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return!1;10==e.level?e.postStoreSpecialAgent():e.postCPSCreateFn()})},resetForm:function(){this.$refs.ruleForm?this.$refs.ruleForm.clearValidate():this.$refs.ruleForm2&&this.$refs.ruleForm2.clearValidate(),this.resetAllType();var n=this._.cloneDeep(this.cleanRuleForm),e=this._.cloneDeep(this.cleanRuleForm2);this.ruleForm=n,this.ruleForm2=e},closeShowFn:function(){this.$emit("closeShowFn")},closedFn:function(){this.level="10",this.resetForm("ruleForm")},postCPSCreateFn:function(){var n=i()(l.a.mark(function n(){var e;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(e=JSON.parse(a()(this.ruleForm))).level=this.level,1==e.level&&delete e.parent_id,e.product_type=e.product_type.concat(e.access_type),delete e.access_type,2==e.level&&(delete e.is_agency,delete e.add_agent,delete e.account_use),1==e.level&&0==e.is_agency&&(delete e.add_agent,delete e.account_use),1==e.level&&1==e.is_agency&&0==e.add_agent&&delete e.account_use,n.next=10,this.$store.dispatch("postCPSCreate",e);case 10:200==n.sent.code&&(this.$message({duration:1500,message:"添加代理成功！",type:"success"}),this.resetForm("ruleForm"),this.closeShowFn());case 12:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),postStoreSpecialAgent:function(){var n=this,e=this.$refs.urlList.urlAll,t=this.$refs.urlList.getAll(),r=Object(f.f)(e.mid_menu),o=Object(f.f)(e.mid_promote),l=e.mid_msg,s=Object(f.f)(e.mid_activity),i=Object(f.f)(e.fall_menu),c=Object(f.f)(e.fall_promote),u=e.fall_msg,p=Object(f.f)(e.fall_activity),d=Object(f.f)(e.fall_pay),m=this._.cloneDeep(this.ruleForm2),_={imgIdx:m.backgroundImg,colorIdx:m.backgroundColor,backgroundImg:1==this.ruleForm2.backgroundImg?"default":this.CpsbackgroundImgList[this.ruleForm2.backgroundImg-1],backgroundColor:1==this.ruleForm2.backgroundColor?"default":this.backgroundColorList[this.ruleForm2.backgroundColor-1]};if(m.material=a()(_),m.level=this.level,delete m.backgroundColor,delete m.backgroundImg,0==m.use_common){if(!this.$refs.urlList.hasSame())return;m.mid_menu=a()(r),m.mid_promote=a()(o),m.mid_msg=a()(l),m.mid_activity=a()(s),m.fall_menu=a()(i),m.fall_promote=a()(c),m.fall_msg=a()(u),m.fall_activity=a()(p),m.fall_pay=a()(d),m.unique_array=a()(t)}m.use_common=Number(m.use_common),this.$store.dispatch("postStoreSpecialAgent",m).then(function(e){200==e.code&&(n.$message({duration:1500,message:"添加代理成功！",type:"success"}),n.resetForm("ruleForm2"),n.closeShowFn(),n.getSpecialAgentList(),setTimeout(function(){location.reload()},1500))})},postCPSUpdateFn:function(){var n=i()(l.a.mark(function n(e,t){var r,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r={id:e.id,url:o})[t]="status"==t?1==e[t]?2:1:1==e[t]?0:1,n.next=4,this.$store.dispatch("postCPSUpdate",r);case 4:200==n.sent.code&&(this.$message({duration:1500,message:"修改成功！",type:"success"}),a=this.cpsAccountList.data.findIndex(function(n){return n.id==e.id}),this.cpsAccountList.data[a][t]=r[t]);case 6:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),specialFilterFn:function(n){var e=this;this.$nextTick(function(){e.allSpecialAgentList=n?e.allSpecialAgentListCopy.filter(function(e){return-1!=e._id.indexOf(n)||(-1!=e.username.indexOf(n)||void 0)}):e._.cloneDeep(e.allSpecialAgentListCopy)})},specialAgentChange:function(){var n=this;2==this.level&&(this.ruleForm.parent_id="",this.resetAllType(),this.$store.dispatch("getLevelOneAgentList",{special_agent:this.ruleForm.special_agent}).then(function(e){200==e.code&&(n.oneAgentList=e.data)}))},parentIdChange:function(n){var e=this;if(2==this.level){var t=this.oneAgentList.find(function(e){return e.id==n});if(t){var r=[],a=[];t.product_type.forEach(function(n){var t=e.cpsAccountType.access_type.find(function(e){return n.product_id==e.id?e:""}),o=e.cpsAccountType.product_type.find(function(e){return n.product_id==e.id?e:""});t&&r.push(t),o&&a.push(o)}),this.newCpsAccountType={access_type:r,product_type:a},this.access_way_type=this.ruleForm.access_way=t.access_way+""}else this.resetAllType()}else this.resetAllType()},resetAllType:function(){this.newCpsAccountType={access_type:this._.cloneDeep(this.cpsAccountType.access_type),product_type:this._.cloneDeep(this.cpsAccountType.product_type)},this.access_way_type="1"}}},g={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",[t("el-dialog",{attrs:{title:"新增代理",visible:n.dialogFormVisible,"close-on-click-modal":!1,"before-close":n.closeShowFn},on:{"update:visible":function(e){n.dialogFormVisible=e},closed:n.closedFn}},[t("label",{staticClass:"level-radio-label"},[n._v("用户级别")]),n._v(" "),t("el-radio-group",{on:{change:n.changLevelFn},model:{value:n.level,callback:function(e){n.level=e},expression:"level"}},[t("el-radio",{attrs:{label:"10"}},[n._v("特级代理")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("一级代理")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("二级代理")])],1),n._v(" "),10!=n.level?[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:n.ruleForm,rules:n.rules,"label-width":"105px"}},[2==n.level?t("el-form-item",{attrs:{label:"账号用途"}},[t("el-radio-group",{model:{value:n.ruleForm.use_type,callback:function(e){n.$set(n.ruleForm,"use_type",e)},expression:"ruleForm.use_type"}},[t("el-radio",{attrs:{label:"1"}},[n._v("自用")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("外发")])],1)],1):n._e(),n._v(" "),t("el-form-item",{attrs:{label:"特级代理",prop:"special_agent"}},[t("el-select",{attrs:{filterable:"","filter-method":n.specialFilterFn,placeholder:"请选择特级代理"},on:{change:n.specialAgentChange},model:{value:n.ruleForm.special_agent,callback:function(e){n.$set(n.ruleForm,"special_agent",e)},expression:"ruleForm.special_agent"}},n._l(n.allSpecialAgentList,function(e){return t("el-option",{key:e.id,attrs:{label:e.username,value:e.id}},[t("span",{staticStyle:{float:"left"}},[n._v(n._s(e._id))]),n._v(" "),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[n._v(n._s(e.username))])])}))],1),n._v(" "),2==n.level?t("el-form-item",{attrs:{label:"一级代理",prop:"parent_id"}},[t("el-select",{attrs:{placeholder:"请选择所属的一级代理ID",disabled:!n.ruleForm.special_agent},on:{change:n.parentIdChange},model:{value:n.ruleForm.parent_id,callback:function(e){n.$set(n.ruleForm,"parent_id",e)},expression:"ruleForm.parent_id"}},n._l(n.oneAgentList,function(n){return t("el-option",{key:n.id,attrs:{label:n.username,value:n.id}})}))],1):n._e(),n._v(" "),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入用户名"},model:{value:n.ruleForm.username,callback:function(e){n.$set(n.ruleForm,"username",e)},expression:"ruleForm.username"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{autocomplete:"new-password",placeholder:"请输入密码",type:"password"},model:{value:n.ruleForm.password,callback:function(e){n.$set(n.ruleForm,"password",e)},expression:"ruleForm.password"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"手机号码",prop:"mobile"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入手机号码"},model:{value:n.ruleForm.mobile,callback:function(e){n.$set(n.ruleForm,"mobile",e)},expression:"ruleForm.mobile"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"佣金比例",prop:"commission_ratio"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入佣金比例"},model:{value:n.ruleForm.commission_ratio,callback:function(e){n.$set(n.ruleForm,"commission_ratio",e)},expression:"ruleForm.commission_ratio"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"账户类型"}},[t("el-radio-group",{model:{value:n.ruleForm.account_type,callback:function(e){n.$set(n.ruleForm,"account_type",e)},expression:"ruleForm.account_type"}},[t("el-radio",{attrs:{label:"1"}},[n._v("对公账户")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("对私账户")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"用户级别"}},[t("el-radio-group",{model:{value:n.ruleForm.is_real,callback:function(e){n.$set(n.ruleForm,"is_real",e)},expression:"ruleForm.is_real"}},[t("el-radio",{attrs:{label:"0"}},[n._v("真实用户")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("测试用户")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"用户属性"}},[t("el-radio-group",{model:{value:n.ruleForm.is_special,callback:function(e){n.$set(n.ruleForm,"is_special",e)},expression:"ruleForm.is_special"}},[t("el-radio",{attrs:{label:"0"}},[n._v("普通用户")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("特殊用户")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"接入类型",prop:"access_type"}},[t("el-checkbox-group",{model:{value:n.ruleForm.access_type,callback:function(e){n.$set(n.ruleForm,"access_type",e)},expression:"ruleForm.access_type"}},n._l(n.newCpsAccountType.access_type,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.id}},[n._v(n._s(e.name))])}))],1),n._v(" "),t("el-form-item",{attrs:{label:"产品种类",prop:"product_type"}},[t("el-checkbox-group",{model:{value:n.ruleForm.product_type,callback:function(e){n.$set(n.ruleForm,"product_type",e)},expression:"ruleForm.product_type"}},n._l(n.newCpsAccountType.product_type,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.id}},[n._v(n._s(e.name))])}))],1),n._v(" "),t("el-form-item",{attrs:{label:"是否强授权"}},[t("el-radio-group",{model:{value:n.ruleForm.is_action_limit,callback:function(e){n.$set(n.ruleForm,"is_action_limit",e)},expression:"ruleForm.is_action_limit"}},[t("el-radio",{attrs:{label:"0"}},[n._v("否")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("是")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"代理管理"}},[t("el-radio-group",{model:{value:n.ruleForm.is_agency,callback:function(e){n.$set(n.ruleForm,"is_agency",e)},expression:"ruleForm.is_agency"}},[t("el-radio",{attrs:{label:"0"}},[n._v("否")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("是")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"接入方式"}},[t("el-radio-group",{model:{value:n.ruleForm.access_way,callback:function(e){n.$set(n.ruleForm,"access_way",e)},expression:"ruleForm.access_way"}},["1"==n.access_way_type?t("el-radio",{attrs:{label:"1"}},[n._v("扫码授权和手动配置")]):n._e(),n._v(" "),"1"==n.access_way_type||"2"==n.access_way_type?t("el-radio",{attrs:{label:"2"}},[n._v("只有扫码授权")]):n._e(),n._v(" "),"1"==n.access_way_type||"3"==n.access_way_type?t("el-radio",{attrs:{label:"3"}},[n._v("只有手动配置")]):n._e()],1)],1),n._v(" "),1==n.level&&1==n.ruleForm.is_agency?t("el-form-item",{attrs:{label:"添加代理商"}},[t("el-radio-group",{model:{value:n.ruleForm.add_agent,callback:function(e){n.$set(n.ruleForm,"add_agent",e)},expression:"ruleForm.add_agent"}},[t("el-radio",{attrs:{label:"1"}},[n._v("可见")]),n._v(" "),t("el-radio",{attrs:{label:"0"}},[n._v("不可见")])],1)],1):n._e(),n._v(" "),1==n.level&&1==n.ruleForm.is_agency&&1==n.ruleForm.add_agent?t("el-form-item",{attrs:{label:"账号用途选项"}},[t("el-radio-group",{model:{value:n.ruleForm.account_use,callback:function(e){n.$set(n.ruleForm,"account_use",e)},expression:"ruleForm.account_use"}},[t("el-radio",{attrs:{label:"1"}},[n._v("只有自用")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("只有外发")]),n._v(" "),t("el-radio",{attrs:{label:"3"}},[n._v("自用和外发")])],1)],1):n._e()],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("ruleForm")}}},[n._v("提交")]),n._v(" "),t("el-button",{on:{click:n.closeShowFn}},[n._v("取消")])],1)]:n._e(),n._v(" "),10==n.level?[t("el-form",{ref:"ruleForm2",staticClass:"demo-ruleForm",attrs:{model:n.ruleForm2,rules:n.rules2,"label-width":"105px"}},[t("el-alert",{staticStyle:{width:"calc(100% - 30px)","margin-left":"28px","margin-bottom":"15px"},attrs:{title:"通用域名配置",type:"warning",closable:!1}}),n._v(" "),t("el-form-item",{attrs:{label:"平台名称",prop:"username"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入平台名称"},model:{value:n.ruleForm2.username,callback:function(e){n.$set(n.ruleForm2,"username",e)},expression:"ruleForm2.username"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"B端后台域名",prop:"domain"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入B端后台域名"},model:{value:n.ruleForm2.domain,callback:function(e){n.$set(n.ruleForm2,"domain",e)},expression:"ruleForm2.domain"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"API",prop:"api"}},[t("el-input",{attrs:{autocomplete:"new-password",placeholder:"请输入API"},model:{value:n.ruleForm2.api,callback:function(e){n.$set(n.ruleForm2,"api",e)},expression:"ruleForm2.api"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"通用域名池"}},[t("el-switch",{model:{value:n.ruleForm2.use_common,callback:function(e){n.$set(n.ruleForm2,"use_common",e)},expression:"ruleForm2.use_common"}})],1),n._v(" "),t("div",[t("url-list",{directives:[{name:"show",rawName:"v-show",value:0==n.ruleForm2.use_common,expression:"ruleForm2.use_common==false"}],ref:"urlList"})],1),n._v(" "),t("el-form-item",{attrs:{label:"主题色",prop:"backgroundColor"}},[t("el-select",{model:{value:n.ruleForm2.backgroundColor,callback:function(e){n.$set(n.ruleForm2,"backgroundColor",e)},expression:"ruleForm2.backgroundColor"}},n._l(n.backgroundColorList,function(n){return t("el-option",{key:n.id,attrs:{label:n.label,value:n.id}})}))],1),n._v(" "),t("el-form-item",{attrs:{prop:"backgroundImg",label:"B端登录背景"}},[t("el-radio-group",{model:{value:n.ruleForm2.backgroundImg,callback:function(e){n.$set(n.ruleForm2,"backgroundImg",e)},expression:"ruleForm2.backgroundImg"}},n._l(n.CpsbackgroundImgList,function(n,e){return t("el-radio",{key:e,staticStyle:{"margin-bottom":"20px"},attrs:{label:e+1}},[t("img",{staticClass:"cps-images-item",attrs:{src:n,alt:""}})])}))],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("ruleForm2")}}},[n._v("提交")]),n._v(" "),t("el-button",{on:{click:n.closeShowFn}},[n._v("取消")])],1)]:n._e()],2)],1)},staticRenderFns:[]};var b=t("VU/8")(v,g,!1,function(n){t("lVRC")},null,null).exports,y={name:"CPSAccountsList",mixins:[d.a],components:{AddAccounts:b},computed:u()({},Object(p.b)({cpsAccountList:"cpsAccountList",cpsAccountType:"cpsAccountType"})),data:function(){return{dialogFormVisible:!1,loading:!1,agentLevel:[{id:"0",name:"全部"},{id:"10",name:"特级代理"},{id:"1",name:"一级代理"},{id:"2",name:"二级代理"}],userLevel:[{id:"0",name:"全部"},{id:"10",name:"真实用户"},{id:"1",name:"测试用户"}],searchCondition:"id",keyword:"",condition:[{value:"id",label:"代理ID"},{value:"username",label:"用户名"},{value:"webchat_name",label:"公众号名"},{value:"mobile",label:"手机号"}],params:{level:"0",is_real:"0",page:1,per_page:20},total:0,data:[{id:"1",name:"2",_book_name:"3",created_at:"4",updated_at:"5"}],userParams:{}}},created:function(){this.firstLoad()},activated:function(){this.firstLoad()},methods:{firstLoad:function(){this.getCPSListFn()},changeConditionFn:function(){this.keyword=""},exportFn:function(){if(0==this.cpsAccountList.total)this.$message({duration:1500,message:"没有要导出的数据！",type:"warning"});else{var n=this._.cloneDeep(this.userParams);n.export_type=2,this.exportExcelFn(n,"/admin/cps_export","账号列表")}},changeSelectFn:function(){this.params.page=1,10==this.params.level&&(this.params.is_real="0"),this.getCPSListFn()},handleCurrentChange:function(n){this.params.page=n,this.getCPSListFn()},handleSizeChange:function(n){this.params.per_page=n,this.getCPSListFn()},fuzzyQueryFn:function(){this.params.page=1,this.getCPSListFn()},handleCommand:function(n,e){1==e?10==n.level?this.$router.push("/CPSManage/accounts/special/"+n.id):this.$router.push("/CPSManage/accounts/edit/"+n.id):5==e?this.$router.push("/CPSManage/accounts/menuconf/"+n.id):this.postCPSUpdateMenuFn(n,e)},postCPSUpdateMenuFn:function(){var n=i()(l.a.mark(function n(e,t){var r,a;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r={id:e.id})[t]="status"==t?1==e[t]?2:1:1==e[t]?0:1,n.next=4,this.$store.dispatch("postCPSChange",r);case 4:200==n.sent.code&&(this.$message({duration:1500,message:"修改成功！",type:"success"}),a=this.cpsAccountList.data.findIndex(function(n){return n.id==e.id}),this.cpsAccountList.data[a][t]=r[t]);case 6:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),getCPSListFn:function(){var n=i()(l.a.mark(function n(){var e,t,r;return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(e=JSON.parse(a()(this.params)))[this.searchCondition]=this.keyword,"id"==this.searchCondition&&(t=new RegExp("T","g"),r=e.id.replace(t,""),e.id=r),this.userParams=this._.clone(e),this.loading=!0,n.next=7,this.$store.dispatch("getCPSList",e);case 7:this.loading=!1;case 8:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),postCPSUpdateFn:function(){var n=i()(l.a.mark(function n(e,t){var r,a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";return l.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(r={id:e.id,url:o})[t]="status"==t?1==e[t]?2:1:1==e[t]?0:1,n.next=4,this.$store.dispatch("postCPSUpdate",r);case 4:200==n.sent.code&&(this.$message({duration:1500,message:"修改成功！",type:"success"}),a=this.cpsAccountList.data.findIndex(function(n){return n.id==e.id}),this.cpsAccountList.data[a][t]=r[t]);case 6:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}(),closeShowFn:function(){this.dialogFormVisible=!1,this.getCPSListFn()}}},F={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container dropdown-container accounts-container",attrs:{id:"accounts"}},[t("div",{staticClass:"bar flex"},[t("div",{staticClass:"flex-left"},[t("label",{staticClass:"radio-label",staticStyle:{"padding-left":"0"}},[n._v("代理级别")]),n._v(" "),t("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择代理级别"},on:{change:n.changeSelectFn},model:{value:n.params.level,callback:function(e){n.$set(n.params,"level",e)},expression:"params.level"}},n._l(n.agentLevel,function(n){return t("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})})),n._v(" "),10!=n.params.level?[t("label",{staticClass:"radio-label"},[n._v("用户级别")]),n._v(" "),t("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"请选择用户级别"},on:{change:n.changeSelectFn},model:{value:n.params.is_real,callback:function(e){n.$set(n.params,"is_real",e)},expression:"params.is_real"}},n._l(n.userLevel,function(n){return t("el-option",{key:n.id,attrs:{label:n.name,value:n.id}})}))]:n._e()],2),n._v(" "),t("div",{staticClass:"flex-right"},[t("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择搜索条件"},on:{change:n.changeConditionFn},model:{value:n.searchCondition,callback:function(e){n.searchCondition=e},expression:"searchCondition"}},n._l(n.condition,function(n){return t("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})})),n._v(" "),t("el-input",{staticStyle:{width:"240px"},attrs:{placeholder:"输入搜索内容",size:"mini","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){if(!("button"in e)&&n._k(e.keyCode,"enter",13,e.key))return null;n.fuzzyQueryFn(e)}},model:{value:n.keyword,callback:function(e){n.keyword=e},expression:"keyword"}}),n._v(" "),t("el-button",{staticClass:"search",attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:n.fuzzyQueryFn}},[n._v("搜索")]),n._v(" "),t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(e){n.dialogFormVisible=!0}}},[n._v("新增")]),n._v(" "),t("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:n.exportFn}},[n._v("导出")])],1)]),n._v(" "),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:n.cpsAccountList.data,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:"代理ID","min-width":"80",fixed:""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(10==e.row.level?"T"+e.row.id:e.row.id))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"app_count",label:"公众号数量","min-width":"150","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.app_count?e.row.app_count:0))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"username",label:"用户名","min-width":"120"}}),n._v(" "),t("el-table-column",{attrs:{prop:"mobile",label:"手机号","min-width":"120","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"_level",label:"代理级别","min-width":"120","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"commission_ratio",label:"佣金比例","min-width":"120","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(10==e.row.level?"-":e.row.commission_ratio))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"push_headcount",label:"总推用户数","min-width":"120","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.push_headcount?e.row.push_headcount:0))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"pay_headcount",label:"充值用户数","min-width":"120","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.pay_headcount?e.row.pay_headcount:0))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"pay_count",label:"用户总充值","min-width":"120","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.pay_count?e.row.pay_count:0))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"balance_count",label:"结算总额","min-width":"120","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.balance_count?e.row.balance_count:0))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"money",label:"可提现余额","min-width":"120","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"120","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:n._u([{key:"default",fn:function(e){return[10==e.row.level?[t("el-button",{attrs:{type:"primary"},on:{click:function(t){n.handleCommand(e.row,"1")}}},[n._v("编辑")])]:[t("el-dropdown",{attrs:{"split-button":"",type:"primary"},on:{command:function(t){n.handleCommand(e.row,t)},click:function(t){n.handleCommand(e.row,"1")}}},[t("span",[n._v("编辑")]),n._v(" "),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"is_real"}},[n._v(n._s(1==e.row.is_real?"真实":"测试"))]),n._v(" "),t("el-dropdown-item",{attrs:{command:"is_special"}},[n._v(n._s(1==e.row.is_special?"普通":"特殊"))]),n._v(" "),t("el-dropdown-item",{attrs:{command:"status"}},[n._v(n._s(1==e.row.status?"禁用":"正常"))])],1)],1)]]}}])})],1),n._v(" "),t("div",{staticClass:"pagination-container clearfix"},[t("div",{staticClass:"float-left"},[t("global-pagination",{attrs:{"current-page":n.params.page,"page-size":n.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:n.cpsAccountList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1)]),n._v(" "),t("add-accounts",{attrs:{dialogFormVisible:n.dialogFormVisible},on:{closeShowFn:n.closeShowFn}})],1)},staticRenderFns:[]};var w=t("VU/8")(y,F,!1,function(n){t("y5Ux")},null,null);e.default=w.exports},MMHQ:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n#accounts .cps-images-item {\n  width: 130px;\n  height: 80px;\n}\n#accounts .level-radio-label {\n  width: 105px;\n  display: inline-block;\n  text-align: right;\n  margin-bottom: 18px;\n  padding-right: 12px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n",""])},lVRC:function(n,e,t){var r=t("G2EQ");"string"==typeof r&&(r=[[n.i,r,""]]),r.locals&&(n.exports=r.locals);t("rjj0")("2014cfee",r,!0)},y5Ux:function(n,e,t){var r=t("MMHQ");"string"==typeof r&&(r=[[n.i,r,""]]),r.locals&&(n.exports=r.locals);t("rjj0")("9207ce7c",r,!0)}});