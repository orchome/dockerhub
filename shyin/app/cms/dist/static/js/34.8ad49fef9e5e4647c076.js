webpackJsonp([34],{Ayod:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=t("Xxa5"),o=t.n(r),a=t("exGp"),i=t.n(a),l=t("Dd8w"),u=t.n(l),s=t("NYxO"),p=t("vU3h"),c=t("5Vl1"),m={components:{PonitTo:p.a,UploadImg:c.a},computed:u()({pointType:function(){var n=this.ruleForm.adhibition,e=[];return 1==n?e=[1,2,3,4,5,6,7,9]:2==n&&(e=[1,2,3,4,5,6,7]),e}},Object(s.b)({}),{isEdit:function(){return"edit"==this.$route.meta.type}}),watch:{},data:function(){return{ruleForm:{adhibition:"1",time:[],client:"",page:"",point:{to_type:"2",to_value:"",to_img:"",resolution:""},frequency:"0"},client_arr:[{label:"PC",value:"1"},{label:"APP",value:"2"},{label:"H5",value:"3"},{label:"小程序",value:"4"},{label:"美图C端H5",value:"5"}],rules:{adhibition:[{required:!0,message:"请选择类型",trigger:"change"}],title:[{required:!0,message:"请输入图片标题",trigger:"blur"}],client:[{required:!0,message:"请选择客户端",trigger:"change"}],time:[{type:"array",required:!0,message:"请选择有效期",trigger:"change"}]}}},created:function(){this.isEdit&&this.getPopupInfoFn(this.$route.params.id)},methods:{getResolutionFn:function(n){this.ruleForm.point.resolution=n},changeClientFn:function(){this.ruleForm.page=""},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return console.log("error submit!!"),!1;if(1!=e.ruleForm.point.to_type&&4!=e.ruleForm.point.to_type&&5!=e.ruleForm.point.to_type&&6!=e.ruleForm.point.to_type||""!=e.ruleForm.point.to_value)if(""==e.ruleForm.point.to_img)e.$message({duration:1500,message:"请上传图片",type:"warning"});else{var t=e._.cloneDeep(e.ruleForm);t.start_time=t.time[0],t.end_time=t.time[1],delete t.time,2!=t.point.to_type&&3!=t.point.to_type&&7!=t.point.to_type&&9!=t.point.to_type||delete t.point.to_value,e.isEdit?e.putPopupUpdateFn(t):e.putPopupAddFn(t)}else e.$message({duration:1500,message:"请输入正确的指向目标",type:"warning"})})},resetForm:function(n){this.$refs[n].resetFields()},goBackFn:function(){this.resetForm("ruleForm"),this.$router.push("/operationManage/cpm")},putPopupUpdateFn:function(){var n=i()(o.a.mark(function n(e){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("putPopupUpdate",e);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"修改成功",type:"success"}),this.goBackFn());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),putPopupAddFn:function(){var n=i()(o.a.mark(function n(e){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("putPopupAdd",e);case 2:200==n.sent.code&&(this.$message({duration:1500,message:"添加成功",type:"success"}),this.goBackFn());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),getPopupInfoFn:function(){var n=i()(o.a.mark(function n(e){var t;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getPopupInfo",{id:e});case 2:200==(t=n.sent).code&&(this.ruleForm={id:t.data.id,time:[t.data.start_time,t.data.end_time],client:t.data.client+"",adhibition:t.data.adhibition+"",page:t.data.page,desc:t.data.desc,point:{to_type:t.data.point[0].to_type+"",to_value:t.data.point[0].to_value,to_img:t.data.point[0].to_img,resolution:t.data.point[0].resolution||""},frequency:t.data.frequency?t.data.frequency+"":"0"},this.client_arr=this.getClientArr(t.data.adhibition));case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),changeType:function(n){var e=n;this.client_arr=this.getClientArr(e),this.ruleForm.client="",this.ruleForm.page=""},getClientArr:function(n){var e=[];return 1==n?e=[{label:"PC",value:"1"},{label:"APP",value:"2"},{label:"H5",value:"3"},{label:"小程序",value:"4"},{label:"美图C端H5",value:"5"}]:2==n&&(e=[{label:"客户端APP",value:"6"}]),e}}},d={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("div",{staticStyle:{width:"600px"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:n.ruleForm,rules:n.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"选择类型",prop:"adhibition"}},[t("el-select",{attrs:{placeholder:"选择应用"},on:{change:n.changeType},model:{value:n.ruleForm.adhibition,callback:function(e){n.$set(n.ruleForm,"adhibition",e)},expression:"ruleForm.adhibition"}},[t("el-option",{attrs:{label:"十音文学",value:"1"}}),n._v(" "),t("el-option",{attrs:{label:"免费小说",value:"2"}})],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"选择客户端",prop:"client"}},[t("el-select",{attrs:{placeholder:"请选择客户端"},on:{change:n.changeClientFn},model:{value:n.ruleForm.client,callback:function(e){n.$set(n.ruleForm,"client",e)},expression:"ruleForm.client"}},n._l(n.client_arr,function(n){return t("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})}))],1),n._v(" "),t("el-form-item",{attrs:{label:"弹窗描述",prop:"desc"}},[t("el-input",{attrs:{placeholder:"请输入弹窗描述"},model:{value:n.ruleForm.desc,callback:function(e){n.$set(n.ruleForm,"desc",e)},expression:"ruleForm.desc"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"上传图片",required:""}},[t("upload-img",{attrs:{picture:n.ruleForm.point.to_img},on:{"update:picture":function(e){n.$set(n.ruleForm.point,"to_img",e)},getResolution:n.getResolutionFn}},[n._v("支持JPG、BMP、PNG、建议尺寸315*369PX")])],1),n._v(" "),t("el-form-item",{attrs:{label:"有效期",prop:"time"}},[t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:n.ruleForm.time,callback:function(e){n.$set(n.ruleForm,"time",e)},expression:"ruleForm.time"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"弹窗频率",required:""}},[t("el-radio-group",{model:{value:n.ruleForm.frequency,callback:function(e){n.$set(n.ruleForm,"frequency",e)},expression:"ruleForm.frequency"}},[t("el-radio",{attrs:{label:"0"}},[n._v("有效期每天弹一次")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("有效期内只弹一次")])],1)],1),n._v(" "),t("ponit-to",{attrs:{"to-type":n.ruleForm.point.to_type,"to-value":n.ruleForm.point.to_value,type:n.pointType},on:{"update:toType":function(e){n.$set(n.ruleForm.point,"to_type",e)},"update:toValue":function(e){n.$set(n.ruleForm.point,"to_value",e)}}}),n._v(" "),t("el-form-item",[t("el-button",{on:{click:function(e){n.goBackFn()}}},[n._v("返回")]),n._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("ruleForm")}}},[n._v("保存")])],1)],1)],1)])},staticRenderFns:[]};var f=t("VU/8")(m,d,!1,function(n){t("hgBD")},null,null);e.default=f.exports},"BYI/":function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},hgBD:function(n,e,t){var r=t("BYI/");"string"==typeof r&&(r=[[n.i,r,""]]),r.locals&&(n.exports=r.locals);t("rjj0")("62884f5e",r,!0)}});