webpackJsonp([42],{Kotg:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},kk3M:function(n,t,e){var r=e("Kotg");"string"==typeof r&&(r=[[n.i,r,""]]),r.locals&&(n.exports=r.locals);e("rjj0")("0275c50a",r,!0)},uFNj:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=e("Xxa5"),i=e.n(r),a=e("exGp"),o=e.n(a),s=e("Dd8w"),u=e.n(s),l=e("NYxO"),c={computed:u()({isEdit:function(){return this.$route.fullPath.indexOf("/edit/")>-1},isAdd:function(){return this.$route.fullPath.indexOf("/add")>-1}},Object(l.b)({})),watch:{},data:function(){return{num1:"",num2:"",pickerOptions:{disabledDate:function(n){return n<new Date}},options:[],loadingBut:!1,loading:!1,ruleForm:{id:"",name:"",recharge:"1",gift:"1",date:[],join_condition:"1",start_time:"",end_time:"",buy_limit_num:"1"},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],date:[{type:"array",required:!0,message:"请选择活动时间",trigger:"change"}],buy_limit_num:[{required:!0,message:"请输入限充次数",trigger:"blur"}]}}},methods:{goBackFn:function(){this.$router.push("/CPSManage/expand/promotion")},submitForm:function(n){var t=this;this.loadingBut=!0,this.$refs[n].validate(function(n){if(!n)return console.log("error submit!!"),t.loadingBut=!1,!1;if(t.ruleForm.recharge&&t.ruleForm.gift){var e=t._.cloneDeep(t.ruleForm);e.date?(e.start_time=~~(Number(e.date[0])/1e3),e.end_time=~~(Number(e.date[1])/1e3)):(e.start_time="",e.end_time=""),delete e.date,t.isEdit&&t.postCPSActivityUpdateFn(e),t.isAdd&&t.postCPSActivityCreateFn(e)}else t.$message({message:"请输入正确的活动金额！",type:"warning",duration:1500})})},resetForm:function(n){this.$refs[n].resetFields()},postCPSActivityCreateFn:function(){var n=o()(i.a.mark(function n(t){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postCPSActivityCreate",t);case 2:200==n.sent.code?(this.$message({message:"添加促销活动成功！",type:"success",duration:1500}),this.$router.push("/CPSManage/expand/promotion")):this.loadingBut=!1;case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),getCPSActivityInfoFn:function(){var n=o()(i.a.mark(function n(t){var e,r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSActivityInfo",{id:t});case 2:if(200==(e=n.sent).code){for(r in this.ruleForm)"date"!==r&&(this.ruleForm[r]=e.data[r]);this.ruleForm.date=[Number(e.data.start_time+"000"),Number(e.data.end_time+"000")]}case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),postCPSActivityUpdateFn:function(){var n=o()(i.a.mark(function n(t){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postCPSActivityUpdate",t);case 2:200==n.sent.code?(this.$message({message:"修改成功！",type:"success",duration:1500}),this.$router.push("/CPSManage/expand/promotion")):this.loadingBut=!1;case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}()},created:function(){var n=o()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.isEdit&&this.getCPSActivityInfoFn(this.$route.params.id);case 1:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),mounted:function(){}},m={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container"},[e("div",[e("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:n.ruleForm,rules:n.rules,"label-width":"100px"}},[e("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"活动名称",prop:"name"}},[e("el-input",{attrs:{placeholder:"请输入活动名称"},model:{value:n.ruleForm.name,callback:function(t){n.$set(n.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),n._v(" "),e("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"活动金额"}},[e("span",{staticStyle:{"margin-right":"10px"}},[n._v("充")]),n._v(" "),e("el-input-number",{attrs:{min:1,max:1e8,"controls-position":"right"},model:{value:n.ruleForm.recharge,callback:function(t){n.$set(n.ruleForm,"recharge",t)},expression:"ruleForm.recharge"}}),n._v(" "),e("span",{staticStyle:{margin:"0 10px"}},[n._v("送")]),n._v(" "),e("el-input-number",{attrs:{min:1,max:1e8,"controls-position":"right"},model:{value:n.ruleForm.gift,callback:function(t){n.$set(n.ruleForm,"gift",t)},expression:"ruleForm.gift"}}),n._v(" "),e("span",{staticStyle:{color:"rgb(188, 188, 188)"}},[n._v("（单位：元）")])],1),n._v(" "),e("el-form-item",{staticStyle:{"min-width":"600px"},attrs:{label:"活动时间",prop:"date"}},[e("el-date-picker",{staticStyle:{width:"400px"},attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:n.ruleForm.date,callback:function(t){n.$set(n.ruleForm,"date",t)},expression:"ruleForm.date"}})],1),n._v(" "),n.isAdd?e("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"活动对象"}},[e("el-radio-group",{model:{value:n.ruleForm.join_condition,callback:function(t){n.$set(n.ruleForm,"join_condition",t)},expression:"ruleForm.join_condition"}},[e("el-radio",{attrs:{label:"0"}},[n._v("全部用户")]),n._v(" "),e("el-radio",{attrs:{label:"1"}},[n._v("首充用户")]),n._v(" "),e("el-radio",{attrs:{label:"2"}},[n._v("非首充用户")])],1),n._v(" "),e("p",{staticStyle:{"font-size":"12px",color:"#999"}},[n._v("（提示：列表仅能创建一个首充活动，创建后如需更改“是否首充”条件请删除后重新创建一个活动）")])],1):n._e(),n._v(" "),e("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"限充次数",prop:"buy_limit_num"}},[e("span",{staticStyle:{"margin-right":"10px"}},[n._v("每人限充")]),n._v(" "),e("el-input-number",{attrs:{min:1,max:1e8,"controls-position":"right"},model:{value:n.ruleForm.buy_limit_num,callback:function(t){n.$set(n.ruleForm,"buy_limit_num",t)},expression:"ruleForm.buy_limit_num"}}),n._v(" "),e("span",{staticStyle:{"margin-left":"10px"}},[n._v("次")])],1),n._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary",loading:n.loadingBut},on:{click:function(t){n.submitForm("ruleForm")}}},[n._v("提交")]),n._v(" "),e("el-button",{on:{click:n.goBackFn}},[n._v("返回")])],1)],1)],1)])},staticRenderFns:[]};var d=e("VU/8")(c,m,!1,function(n){e("kk3M")},null,null);t.default=d.exports}});