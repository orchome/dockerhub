webpackJsonp([95],{"0Wnp":function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,'\n.time {\r\n  font-size: 13px;\r\n  color: #999;\n}\n.mod-pic-wrapper {\r\n  position: relative;\n}\n.mod-pic {\r\n  position: absolute;\r\n  right: 10px;\r\n  top: 10px;\n}\n.activity-wrapper {\r\n  position: relative;\n}\n.activity-wrapper .text {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  z-index: 12;\r\n  background: #fff;\r\n  padding: 10px;\n}\n.activity-wrapper .text h6 {\r\n  font-size: 20px;\r\n  margin: 20px 0;\n}\n.activity-wrapper .text p {\r\n  margin: 0;\n}\r\n/* .bottom {\r\n  margin-top: 13px;\r\n  line-height: 12px;\r\n} */\n.button {\r\n  padding: 0;\r\n  float: right;\n}\n.image {\r\n  width: 100%;\r\n  display: block;\n}\n.clearfix:before,\r\n.clearfix:after {\r\n  display: table;\r\n  content: "";\n}\n.clearfix:after {\r\n  clear: both;\n}\r\n',""])},JDiz:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Xxa5"),r=i.n(a),l=i("exGp"),n=i.n(l),s=i("Dd8w"),c=i.n(s),o=i("NYxO"),p={computed:c()({},Object(o.b)({}),{qiNiuHost:function(){return"http://res.shiyin.net/"}}),watch:{dialogVisibleTitle:function(t){t||this.resetForm("ruleForm")}},data:function(){return{dialogType:"activity",loadingBut:!1,rules:{title_id:[{required:!0,message:"请选择标题",trigger:"change"}],activity_id:[{required:!0,message:"请选择链接",trigger:"change"}]},ruleForm:{activity_id:"",title_id:""},allActiveLink:[],allMaterialTitle:[],dialogVisibleTitle:!1,load:!1,dialogVisible:!1,allMaterialPic:{},activityTemplate:{title:{title:"暂无标题"}},rechargeTemplate:{image:{id:0,pic:"/backend/promotion/recharge.jpg"},title:{id:0,title:"暂无标题"}},page:0}},created:function(){this.getCPSPushTemplateListFn(),this.getCPSPushTemplatePicFn(),this.getCPSPushTemplateTitle(),this.getCPSPushTemplateLink()},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.loadingBut=!1,!1;e.loadingBut=!0;var i={};"activity"==e.dialogType?(i.type="activity",i.title_id=e.ruleForm.title_id,i.activity_id=e.ruleForm.activity_id):(i.type="recharge",i.title_id=e.ruleForm.title_id),e.postCPSPushTemplateUpdate(i)})},resetForm:function(t){this.$refs[t].resetFields(),this.dialogVisibleTitle=!1},getCPSPushTemplateTitle:function(){var t=n()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("getCPSPushTemplateTitle",{});case 2:200==(e=t.sent).code&&(this.allMaterialTitle=e.data.data);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getCPSPushTemplateLink:function(){var t=n()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("getCPSPushTemplateLink",{});case 2:200==(e=t.sent).code&&(this.allActiveLink=e.data);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),postCPSPushTemplateUpdate:function(){var t=n()(r.a.mark(function t(e){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._.cloneDeep(e),t.next=3,this.$store.dispatch("postCPSPushTemplateUpdate",i);case 3:200==t.sent.code&&(this.$message({duration:1500,message:"修改成功！",type:"success"}),a=this.allMaterialTitle.find(function(t){return t.id==i.title_id}),"activity"==i.type?this.activityTemplate.title.title=a.title||"":this.rechargeTemplate.title.title=a.title||"",this.dialogVisibleTitle=!1),this.loadingBut=!1;case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),selectPictureFn:function(){var t=n()(r.a.mark(function t(e,i,a){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("postCPSPushTemplateUpdate",{type:e,img_id:i});case 2:200==t.sent.code&&(this.rechargeTemplate.image={id:0,pic:a},this.$message({duration:1500,message:"修改成功！",type:"success"}),this.dialogVisible=!1);case 4:case"end":return t.stop()}},t,this)}));return function(e,i,a){return t.apply(this,arguments)}}(),getCPSPushTemplatePicFn:function(){var t=n()(r.a.mark(function t(){var e,i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.load=!0,e=this.page,t.next=4,this.$store.dispatch("getCPSPushTemplatePic",{page:this.page+1});case 4:200==(i=t.sent).code?(a=[],a=1!=i.data.current_page?this.allMaterialPic.data.concat(i.data.data):i.data.data,this.allMaterialPic={data:a,total:i.data.total,last_page:i.data.last_page,current_page:i.data.current_page},this.page=i.data.current_page):this.page=e,this.load=!1;case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getCPSPushTemplateListFn:function(){var t=n()(r.a.mark(function t(){var e;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("getCPSPushTemplateList");case 2:if(200==(e=t.sent).code){try{this.rechargeTemplate={image:e.data.rechargeTemplate.imagetexts&&e.data.rechargeTemplate.imagetexts.length>0&&e.data.rechargeTemplate.imagetexts[0].image?e.data.rechargeTemplate.imagetexts[0].image:{id:0,pic:"/backend/promotion/recharge.png"},title:e.data.rechargeTemplate.imagetexts&&e.data.rechargeTemplate.imagetexts.length>0&&e.data.rechargeTemplate.imagetexts[0]?e.data.rechargeTemplate.imagetexts[0].title||"暂无标题":{id:0,title:"暂无标题"}}}catch(t){console.error(t)}e.data.activityTemplate.title=e.data.activityTemplate.title||{title:"暂无标题"},this.activityTemplate=e.data.activityTemplate}case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("el-row",[i("el-col",{attrs:{span:8}},[i("h3",[t._v("首充模板")]),t._v(" "),i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("div",{staticClass:"mod-pic-wrapper"},[i("img",{staticClass:"image",attrs:{src:t.qiNiuHost+t.rechargeTemplate.image.pic}}),t._v(" "),i("el-button",{staticClass:"mod-pic",attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!0,t.dialogType="recharge"}}},[t._v("修改图片")])],1),t._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("span",{staticStyle:{color:"red"}},[t._v(t._s(t.rechargeTemplate.title.title))]),t._v(" "),i("div",{staticClass:"bottom clearfix"},[i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){t.dialogVisibleTitle=!0,t.dialogType="recharge"}}},[t._v("修改标题")])],1)])])],1),t._v(" "),i("el-col",{attrs:{span:8,offset:2}},[i("h3",[t._v("活动促销模板")]),t._v(" "),i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("div",{staticStyle:{padding:"14px"}},[i("div",{staticClass:"text"},[i("h6",[t._v("书币优惠活动")]),t._v(" "),i("p",{staticStyle:{color:"red"}},[t._v(t._s(t.activityTemplate.title.title))]),t._v(" "),i("h6",[t._v("猜您喜欢以下书籍：")]),t._v(" "),i("p",[t._v("→书名")]),t._v(" "),i("p",[t._v("→书名")]),t._v(" "),i("p",[t._v("→书名")]),t._v(" "),i("h6",[t._v("为方便下次阅读，请置顶公众号")])]),t._v(" "),i("div",{staticClass:"bottom clearfix"},[i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){t.dialogVisibleTitle=!0,t.dialogType="activity"}}},[t._v("编辑")])],1)])])],1)],1),t._v(" "),i("el-dialog",{staticClass:"dialogPic",attrs:{title:"选择封面(双击选中图片)",visible:t.dialogVisible,width:"820px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-row",{attrs:{gutter:10}},t._l(t.allMaterialPic.data,function(e){return i("el-col",{key:e.id,attrs:{span:6}},[i("div",{staticStyle:{width:"80%",margin:"0 auto","text-align":"center"}},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.qiNiuHost+e.pic,alt:""},on:{dblclick:function(i){t.selectPictureFn("recharge",e.id,e.pic)}}})])])})),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"spinner-wrap",staticStyle:{"text-align":"center"}},[t.allMaterialPic.last_page==t.allMaterialPic.current_page?i("span",[t._v("全部加载完毕")]):i("el-button",{attrs:{type:"primary",loading:t.load},on:{click:function(e){t.getCPSPushTemplatePicFn()}}},[t._v(t._s(t.load?"加载中":" 点击加载"))])],1)])],1),t._v(" "),i("el-dialog",{staticClass:"dialogPic",attrs:{title:"选择标题",visible:t.dialogVisibleTitle,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisibleTitle=e}}},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"标题",prop:"title_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择标题"},model:{value:t.ruleForm.title_id,callback:function(e){t.$set(t.ruleForm,"title_id",e)},expression:"ruleForm.title_id"}},t._l(t.allMaterialTitle,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}))],1),t._v(" "),"activity"==t.dialogType?i("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"链接",prop:"activity_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择链接"},model:{value:t.ruleForm.activity_id,callback:function(e){t.$set(t.ruleForm,"activity_id",e)},expression:"ruleForm.activity_id"}},t._l(t.allActiveLink,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1):t._e(),t._v(" "),i("el-form-item",[i("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[i("el-button",{attrs:{type:"primary",loading:t.loadingBut},on:{click:function(e){t.submitForm("ruleForm")}}},[t._v("提交")]),t._v(" "),i("el-button",{on:{click:function(e){t.resetForm("ruleForm")}}},[t._v("返回")])],1)])],1)],1)],1)},staticRenderFns:[]};var u=i("VU/8")(p,d,!1,function(t){i("bYNc")},null,null);e.default=u.exports},bYNc:function(t,e,i){var a=i("0Wnp");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("8aeb30f6",a,!0)}});