webpackJsonp([23],{"89Yw":function(e,t,r){(e.exports=r("FZ+f")(!1)).push([e.i,"\n.system-admin-edit[data-v-6ce94f70] {\r\n  background-color: #fff;\n}\r\n",""])},O8DI:function(e,t,r){var o=r("89Yw");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);r("rjj0")("46356c75",o,!0)},StPp:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("Xxa5"),i=r.n(o),a=r("exGp"),s=r.n(a),n=r("mvHQ"),l=r.n(n),d=r("Dd8w"),u=r.n(d),c=r("NYxO"),m=r("msXN"),p=r("E4LH"),f={computed:u()({},Object(c.b)({}),{isEdit:function(){return this.$route.path.indexOf("edit")>-1}}),watch:{},mixins:[m.a],data:function(){var e=this,t=function(t,r,o){if(1==e.ruleForm.type&&0==r.length)return o(new Error("请选择书籍"));o()},r=function(e,t,r){return 0==t.length?r(new Error("请输入邮箱")):Object(p.d)(t)?void r():r(new Error("请输入正确的邮箱地址"))};return{ruleForm:{name:"",type:"0",password:"",ePassword:"",fbook_ids:[],role_id:"",email:""},options:[],loadingSelect:!1,loading:!1,addRules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],password:[{required:!0,validator:function(e,t,r){return t?t.length<5?r(new Error("密码不能小于5位")):void r():r(new Error("请输入密码"))},trigger:"blur"}],role_id:[{required:!0,message:"请选择角色",trigger:"change"}],type:[{required:!0,message:"请选择书籍数据权限",trigger:"blur"}],fbook_ids:[{required:!0,validator:t,trigger:"change"}],email:[{required:!0,validator:r,trigger:"blur"}]},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],ePassword:[{validator:function(t,r,o){if(r&&e.ruleForm.password&&r!=e.ruleForm.password)return o(new Error("两次输入密码不一致"));o()},trigger:"blur"}],role_id:[{required:!0,message:"请选择角色",trigger:"change"}],type:[{required:!0,message:"请选择书籍数据权限",trigger:"blur"}],fbook_ids:[{required:!0,validator:t,trigger:"change"}],email:[{required:!0,validator:r,trigger:"blur"}]},bookList:[],bookListAll:[]}},methods:{handleCheckChange:function(){},submitForm:function(){var e=this;this.$refs.ruleForm.validate(function(t){if(!t)return!1;var r=JSON.parse(l()(e.ruleForm));r.books=r.fbook_ids.join(","),delete r.fbook_ids,e.isEdit?e.upDateFn(r):e.addFn(r)})},upDateFn:function(e){var t=this;this.$store.dispatch("putAdminUpdate",e).then(function(e){200==e.code&&(t.$message({type:"success",message:"编辑成功"}),t.goBackFn())})},addFn:function(e){var t=this;this.$store.dispatch("postAdminCreate",e).then(function(e){200==e.code&&(t.$message({type:"success",message:"添加成功"}),t.goBackFn())})},goBackFn:function(){this.closeSelectedTag("/systemAdmin/administrator")},remoteMethod:function(e){var t=this;""!==e?(this.loadingSelect=!0,setTimeout(function(){t.loadingSelect=!1,t.bookList=t.bookListAll.filter(function(t){return String(t.id).indexOf(e)>-1||t.name.indexOf(e)>-1})},200)):this.bookList=[]},getShiYinBookFn:function(){var e=s()(i.a.mark(function e(){var t=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$store.dispatch("getShiYinBook").then(function(e){200==e.code&&(t.bookListAll=JSON.parse(l()(e.data)),t.loading=!1)});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getDetailFn:function(){var e=s()(i.a.mark(function e(t){var r,o,a,s=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.next=3,this.$store.dispatch("getAdminInfo",{id:t});case 3:200==(o=e.sent).code&&(delete o.data.created_at,delete o.data.updated_at,(a=o.data).type=a.type+"",o.data.books?(a.fbook_ids=[],o.data.books.split(",").forEach(function(e){var t=Number(e);a.fbook_ids.push(t),s.bookListAll.forEach(function(e){e.id==t&&r.push(e)})}),this.bookList=r):(a.fbook_ids=[],a.type="0"),this.ruleForm=a);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getRoleAllFn:function(){var e=s()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("getgetRoleAll");case 2:200==(t=e.sent).code&&(this.options=t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},created:function(){var e=this;this.getRoleAllFn(),this.getShiYinBookFn().then(function(){e.isEdit&&e.getDetailFn(e.$route.params.id)})}},h={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container system-admin-edit"},[r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{width:"500px"},attrs:{model:e.ruleForm,rules:e.isEdit?e.rules:e.addRules,"label-width":"125px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入用户名",disabled:e.isEdit},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),e.isEdit?r("el-form-item",{attrs:{label:"确认密码",prop:"ePassword"}},[r("el-input",{attrs:{placeholder:"请确认密码",type:"password"},model:{value:e.ruleForm.ePassword,callback:function(t){e.$set(e.ruleForm,"ePassword",t)},expression:"ruleForm.ePassword"}})],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"选择角色",prop:"role_id"}},[r("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.ruleForm.role_id,callback:function(t){e.$set(e.ruleForm,"role_id",t)},expression:"ruleForm.role_id"}},e._l(e.options,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"书籍数据权限",prop:"type"}},[r("el-radio-group",{model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},[r("el-radio",{attrs:{label:"0"}},[e._v("所有书籍")]),e._v(" "),r("el-radio",{attrs:{label:"1"}},[e._v("部分书籍")])],1)],1),e._v(" "),1==e.ruleForm.type?r("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"书籍",prop:"fbook_ids"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入小说名称/小说ID",multiple:"",filterable:"",remote:"","reserve-keyword":"","remote-method":e.remoteMethod,loading:e.loadingSelect},model:{value:e.ruleForm.fbook_ids,callback:function(t){e.$set(e.ruleForm,"fbook_ids",t)},expression:"ruleForm.fbook_ids"}},e._l(e.bookList,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}},[r("span",{staticStyle:{float:"left"}},[e._v(e._s(t.id))]),e._v(" "),r("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.name))])])}))],1):e._e(),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("提交")]),e._v(" "),r("el-button",{on:{click:e.goBackFn}},[e._v("返回")])],1)],1)],1)},staticRenderFns:[]};var g=r("VU/8")(f,h,!1,function(e){r("O8DI")},"data-v-6ce94f70",null);t.default=g.exports}});