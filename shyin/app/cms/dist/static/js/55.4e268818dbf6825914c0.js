webpackJsonp([55],{E9YP:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},Htdj:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n.avatar-uploader .el-upload {\r\n\tborder: 1px dashed #d9d9d9;\r\n\tborder-radius: 6px;\r\n\tcursor: pointer;\r\n\tposition: relative;\r\n\toverflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\r\n\tborder-color: #409eff;\n}\n.avatar-uploader-icon {\r\n\tfont-size: 28px;\r\n\tcolor: #8c939d;\r\n\twidth: 178px;\r\n\theight: 178px;\r\n\tline-height: 178px;\r\n\ttext-align: center;\n}\n.avatar {\r\n\twidth: 178px;\r\n\theight: 178px;\r\n\tdisplay: block;\n}\r\n",""])},Jrw8:function(n,e,t){var a=t("E9YP");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("37464274",a,!0)},SNNS:function(n,e,t){var a=t("lK5H");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("12027cf3",a,!0)},eg6K:function(n,e,t){var a=t("fEBQ");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("4fe57fc8",a,!0)},fEBQ:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},gA9Q:function(n,e,t){var a=t("Htdj");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("b3c15c7c",a,!0)},lK5H:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},phGE:function(n,e,t){(n.exports=t("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},qi1d:function(n,e,t){var a=t("phGE");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("rjj0")("444f717e",a,!0)},tjty:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("RRo+"),r=t.n(a),o=t("Dd8w"),s=t.n(o),i=t("NYxO"),l=t("0xDb"),c=t("Vjby"),p=t("Xxa5"),u=t.n(p),m=t("mvHQ"),d=t.n(m),_=t("exGp"),f=t.n(_),h={data:function(){return{id:this.$route.params.id,userForm:{parent_id:"",username:"",password:"",mobile:"",commission_ratio:0,level:"1",is_real:"0",account_type:"1",is_special:"2",access_type:[],product_type:[],is_action_limit:"1",use_type:"",is_agency:"0",add_agent:"0",account_use:"1",access_way:"1"},userRules:{parent_id:[{required:!0,validator:function(n,e,t){e||e+""=="0"||t(new Error("请输入一级代理ID")),setTimeout(function(){r()(Number(e))?t():t(new Error("请输入数字值"))},1e3)},trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,validator:function(n,e,t){Object(l.a)(e)?t():t(new Error("密码必须为字母加数字且长度不小于8位"))},trigger:"blur"}],mobile:[{required:!0,validator:function(n,e,t){e&&/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)?t():t(new Error("请输入正确的11位手机号码"))},trigger:"blur"}],access_type:[{required:!0,type:"array",message:"请选择公众号类型",trigger:"change"}],product_type:[{required:!0,type:"array",message:"请选择产品种类",trigger:"change"}],commission_ratio:[{required:!0,validator:function(n,e,t){e||e+""=="0"?Number(e)||e+""=="0"?Number(e)>1||Number(e)<0?t(new Error("请输入0-1之间小数的佣金比例")):t():t(new Error("请输入数字值")):t(new Error("佣金比例不能为空"))},trigger:"blur"}]},product_type:[],access_type:[],parentUserForm:{},allCpsAccountType:{access_type:[],product_type:[]},access_way_type:1,tempUserForm:{},parentName:""}},created:function(){this.getCPSInfoFn()},methods:{submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return!1;e.postCPSUpdateFn()})},postCPSUpdateFn:function(){var n=f()(u.a.mark(function n(){var e;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e={},(e=JSON.parse(d()(this.userForm))).product_type=e.product_type.concat(e.access_type),delete e.access_type,2==e.level&&(delete e.is_agency,delete e.add_agent,delete e.account_use),1==e.level&&0==e.is_agency&&(delete e.add_agent,delete e.account_use),1==e.level&&1==e.is_agency&&0==e.add_agent&&delete e.account_use,e.id=this.id,e.url="info",e.updated_at=Object(l.k)(new Date),n.next=12,this.$store.dispatch("postCPSUpdate",e);case 12:200==n.sent.code&&(this.$message({duration:1500,message:"修改个人信息成功!",type:"success"}),this.getCPSInfoFn());case 14:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),getCPSInfoFn:function(){var n=f()(u.a.mark(function n(){var e,t,a,r,o,s,i=this;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSInfo",{id:this.id,url:"info"});case 2:200==(e=n.sent).code&&(t=e.data,a=t.specialAgent[0].username||"-",r=t.specialAgent[0].id||"-",this.parentName=a+"  (T"+r+")",this.userForm={parent_id:t.parent_id||"",username:t.username,password:"",mobile:t.mobile,commission_ratio:t.commission_ratio,level:t.level+"",is_real:t.is_real+"",account_type:t.account_type+"",is_special:t.is_special+"",access_type:[],product_type:[],is_action_limit:t.is_action_limit+"",use_type:"0"==t.use_type?"2":t.use_type+"",is_agency:t.is_agency?t.is_agency+"":"0",add_agent:t.add_agent?t.add_agent+"":"0",account_use:t.account_use?t.account_use+"":"1",access_way:t.access_way?t.access_way+"":"1"},o=[],s=[],t.app_types.forEach(function(n){1==n.product_type?s.push(n):2==n.product_type&&o.push(n)}),t.product_type.forEach(function(n){var e=t.app_types.findIndex(function(e){return e.id==n.product_id});e>-1&&(1==t.app_types[e].product_type?i.userForm.access_type.push(t.app_types[e].id):2==t.app_types[e].product_type&&i.userForm.product_type.push(t.app_types[e].id))}),this.allCpsAccountType={access_type:s,product_type:o},this.product_type=o,this.access_type=s,this.tempUserForm=JSON.parse(d()(this.userForm)),2==this.userForm.level&&this.getParentDetail(this.userForm.parent_id));case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),getParentDetail:function(){var n=f()(u.a.mark(function n(e){var t;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSInfo",{id:e,url:"info"});case 2:200==(t=n.sent).code&&(this.parentUserForm={product_type:t.data.product_type,access_way:t.data.access_way},this.getParentType());case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),getParentType:function(){var n=this;if(2==this.userForm.level){var e=this.parentUserForm;if(e){var t=[],a=[];e.product_type.forEach(function(e){var r=n.allCpsAccountType.access_type.find(function(n){return e.product_id==n.id?n:""}),o=n.allCpsAccountType.product_type.find(function(n){return e.product_id==n.id?n:""});r&&t.push(r),o&&a.push(o)}),this.access_type=t,this.product_type=a,this.access_way_type=e.access_way+""}else this.resetAllType()}else this.resetAllType()},resetAllType:function(){this.access_type=this._.cloneDeep(this.allCpsAccountType.access_type),this.product_type=this._.cloneDeep(this.allCpsAccountType.product_type),this.access_way_type="1"},resetForm:function(n){this.showApp=!1,this.$refs[n].resetFields(),this.closeSelectedTag("/CPSManage/accounts")}}},v={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-form",{ref:"userForm",staticClass:"demo-ruleForm",staticStyle:{width:"600px"},attrs:{model:n.userForm,"label-width":"100px",rules:n.userRules}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==n.userForm.level,expression:"userForm.level==1"}],attrs:{label:"特级代理"}},[t("div",[n._v(n._s(n.parentName))])]),n._v(" "),t("el-form-item",{attrs:{label:"代理级别"}},[t("el-radio-group",{attrs:{disabled:!0},model:{value:n.userForm.level,callback:function(e){n.$set(n.userForm,"level",e)},expression:"userForm.level"}},[t("el-radio",{attrs:{label:"1"}},[n._v("一级代理")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("二级代理")])],1)],1),n._v(" "),2==n.userForm.level?t("el-form-item",{attrs:{label:"账号用途"}},[t("el-radio-group",{model:{value:n.userForm.use_type,callback:function(e){n.$set(n.userForm,"use_type",e)},expression:"userForm.use_type"}},[t("el-radio",{attrs:{label:"1"}},[n._v("自用")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("外发")])],1)],1):n._e(),n._v(" "),2==n.userForm.level?t("el-form-item",{attrs:{label:"一级代理",prop:"parent_id"}},[t("el-input",{attrs:{placeholder:"请输入所属的一级代理ID",disabled:!0},model:{value:n.userForm.parent_id,callback:function(e){n.$set(n.userForm,"parent_id",e)},expression:"userForm.parent_id"}})],1):n._e(),n._v(" "),t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:n.userForm.username,callback:function(e){n.$set(n.userForm,"username",e)},expression:"userForm.username"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"密码"}},[t("el-input",{attrs:{placeholder:"请输入密码",type:"password"},model:{value:n.userForm.password,callback:function(e){n.$set(n.userForm,"password",e)},expression:"userForm.password"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"手机号码",prop:"mobile"}},[t("el-input",{attrs:{placeholder:"请输入手机号码"},model:{value:n.userForm.mobile,callback:function(e){n.$set(n.userForm,"mobile",e)},expression:"userForm.mobile"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"佣金比例",prop:"commission_ratio"}},[t("el-input",{attrs:{placeholder:"请输入佣金比例"},model:{value:n.userForm.commission_ratio,callback:function(e){n.$set(n.userForm,"commission_ratio",e)},expression:"userForm.commission_ratio"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"用户级别"}},[t("el-radio-group",{model:{value:n.userForm.is_real,callback:function(e){n.$set(n.userForm,"is_real",e)},expression:"userForm.is_real"}},[t("el-radio",{attrs:{label:"0"}},[n._v("真实用户")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("测试用户")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"用户属性"}},[t("el-radio-group",{model:{value:n.userForm.is_special,callback:function(e){n.$set(n.userForm,"is_special",e)},expression:"userForm.is_special"}},[t("el-radio",{attrs:{label:"0"}},[n._v("普通用户")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("特殊用户")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"账户类型"}},[t("el-radio-group",{model:{value:n.userForm.account_type,callback:function(e){n.$set(n.userForm,"account_type",e)},expression:"userForm.account_type"}},[t("el-radio",{attrs:{label:"1"}},[n._v("对公账户")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("对私账户")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"接入类型",prop:"access_type"}},[t("el-checkbox-group",{model:{value:n.userForm.access_type,callback:function(e){n.$set(n.userForm,"access_type",e)},expression:"userForm.access_type"}},n._l(n.access_type,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.id}},[n._v(n._s(e.name))])}))],1),n._v(" "),t("el-form-item",{attrs:{label:"产品种类",prop:"product_type"}},[t("el-checkbox-group",{model:{value:n.userForm.product_type,callback:function(e){n.$set(n.userForm,"product_type",e)},expression:"userForm.product_type"}},n._l(n.product_type,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.id}},[n._v(n._s(e.name))])}))],1),n._v(" "),t("el-form-item",{attrs:{label:"是否强授权"}},[t("el-radio-group",{model:{value:n.userForm.is_action_limit,callback:function(e){n.$set(n.userForm,"is_action_limit",e)},expression:"userForm.is_action_limit"}},[t("el-radio",{attrs:{label:"0"}},[n._v("否")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("是")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"代理管理"}},[t("el-radio-group",{model:{value:n.userForm.is_agency,callback:function(e){n.$set(n.userForm,"is_agency",e)},expression:"userForm.is_agency"}},[t("el-radio",{attrs:{label:"0"}},[n._v("否")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("是")])],1)],1),n._v(" "),1==n.userForm.level&&1==n.userForm.is_agency?t("el-form-item",{attrs:{label:"添加代理商"}},[t("el-radio-group",{model:{value:n.userForm.add_agent,callback:function(e){n.$set(n.userForm,"add_agent",e)},expression:"userForm.add_agent"}},[t("el-radio",{attrs:{label:"1"}},[n._v("可见")]),n._v(" "),t("el-radio",{attrs:{label:"0"}},[n._v("不可见")])],1)],1):n._e(),n._v(" "),1==n.userForm.level&&1==n.userForm.is_agency&&1==n.userForm.add_agent?t("el-form-item",{attrs:{label:"账号用途选项"}},[t("el-radio-group",{model:{value:n.userForm.account_use,callback:function(e){n.$set(n.userForm,"account_use",e)},expression:"userForm.account_use"}},[t("el-radio",{attrs:{label:"1"}},[n._v("只有自用")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("只有外发")]),n._v(" "),t("el-radio",{attrs:{label:"3"}},[n._v("自用和外发")])],1)],1):n._e(),n._v(" "),t("el-form-item",{attrs:{label:"接入方式"}},[t("el-radio-group",{model:{value:n.userForm.access_way,callback:function(e){n.$set(n.userForm,"access_way",e)},expression:"userForm.access_way"}},["1"==n.access_way_type?t("el-radio",{attrs:{label:"1"}},[n._v("扫码授权和手动配置")]):n._e(),n._v(" "),"1"==n.access_way_type||"2"==n.access_way_type?t("el-radio",{attrs:{label:"2"}},[n._v("只有扫码授权")]):n._e(),n._v(" "),"1"==n.access_way_type||"3"==n.access_way_type?t("el-radio",{attrs:{label:"3"}},[n._v("只有手动配置")]):n._e()],1)],1),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("userForm")}}},[n._v("提交")]),n._v(" "),t("el-button",{on:{click:function(e){n.resetForm("userForm")}}},[n._v("返回")])],1)],1)},staticRenderFns:[]};var b=t("VU/8")(h,v,!1,function(n){t("eg6K")},null,null).exports,y={data:function(){return{id:this.$route.params.id,collectionForm:{type:"3",name:"",account_num:"",bank_name:"",bank_mobile:"",deposit_bank:"",openid:"",alipay:""},collectionrules:{parent_id:[{required:!0,validator:function(n,e,t){e||e+""=="0"||t(new Error("请输入一级代理ID")),setTimeout(function(){r()(Number(e))?t():t(new Error("请输入数字值"))},1e3)},trigger:"blur"}],name:[{required:!0,message:"请输入收款名",trigger:"blur"}],account_num:[{required:!0,message:"请输入银行账号",trigger:"blur"}],bank_name:[{required:!0,message:"请输入银行名称",trigger:"blur"}],deposit_bank:[{required:!0,message:"请输入开户行",trigger:"blur"}],bank_mobile:[{required:!0,validator:function(n,e,t){e&&/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)?t():t(new Error("请输入正确的11位手机号码"))},trigger:"blur"}],alipay:[{required:!0,message:"请输入支付宝账号",trigger:"blur"}]},account_type:{}}},created:function(){this.getCPSInfoFn2(),this.getCPSInfoFn()},methods:{getCPSInfoFn:function(){var n=f()(u.a.mark(function n(){var e,t,a,r,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSInfo",{id:this.id,url:"receipt"});case 2:200==(e=n.sent).code&&(t=e.data,a=t.find(function(n){return 1==n.type}),r=t.find(function(n){return 2==n.type}),o=t.find(function(n){return 3==n.type}),""!==s&&console.log(s),this.collection=[{type:"1",alipay:a?a.account_num:"",name:a?a.name:""},{type:"2",openid:r?r.openid:"",name:r?r.name:""},{type:"3",name:o?o.name:"",account_num:o?o.account_num:"",bank_name:o?o.bank_name:"",bank_mobile:o?o.bank_mobile:"",deposit_bank:o?o.deposit_bank:""}],this.collectionForm=s?JSON.parse(d()(this.collection[s-1])):JSON.parse(d()(this.collection[2])));case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),getCPSInfoFn2:function(){var n=f()(u.a.mark(function n(){var e,t;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSInfo",{id:this.id,url:"info"});case 2:e=n.sent,t=e.data,this.account_type=t.account_type;case 5:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),changeReceiptTypeFn:function(n){var e=this;this.collectionForm=JSON.parse(d()(this.collection[n-1])),this.$nextTick(function(){e.$refs.collectionForm.clearValidate()})},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return!1;e.postCPSUpdateFn()})},postCPSUpdateFn:function(){var n=f()(u.a.mark(function n(){var e;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e={},1==(e=JSON.parse(d()(this.collectionForm))).type?(e.account_num=e.alipay,e.alipay=""):2==e.type&&(e.account_num=e.unionid,e.unionid=""),e.id=this.id,e.url="receipt",n.next=7,this.$store.dispatch("postCPSUpdate",e);case 7:200==n.sent.code&&(this.$message({duration:1500,message:"修改收款信息成功!",type:"success"}),this.getCPSInfoFn(this.collectionForm.type));case 9:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),resetForm:function(n){this.showApp=!1,this.$refs[n].resetFields(),this.closeSelectedTag("/CPSManage/accounts")}}},g={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-form",{ref:"collectionForm",staticClass:"demo-ruleForm",staticStyle:{width:"600px"},attrs:{model:n.collectionForm,"label-width":"100px",rules:n.collectionrules}},[t("el-form-item",{attrs:{label:"收款方式"}},[t("el-radio-group",{on:{change:n.changeReceiptTypeFn},model:{value:n.collectionForm.type,callback:function(e){n.$set(n.collectionForm,"type",e)},expression:"collectionForm.type"}},[t("el-radio",{attrs:{label:"3"}},[n._v("银行")]),n._v(" "),t("el-radio",{attrs:{label:"2"}},[n._v("微信")]),n._v(" "),t("el-radio",{attrs:{label:"1"}},[n._v("支付宝")])],1)],1),n._v(" "),2==n.collectionForm.type?t("el-form-item",{attrs:{label:"微信openid"}},[t("el-input",{attrs:{disabled:"",placeholder:"请输入微信openid"},model:{value:n.collectionForm.openid,callback:function(e){n.$set(n.collectionForm,"openid",e)},expression:"collectionForm.openid"}})],1):n._e(),n._v(" "),1==n.collectionForm.type?t("el-form-item",{attrs:{label:"支付宝账号",prop:"alipay"}},[t("el-input",{attrs:{placeholder:"请输入支付宝名称"},model:{value:n.collectionForm.alipay,callback:function(e){n.$set(n.collectionForm,"alipay",e)},expression:"collectionForm.alipay"}})],1):n._e(),n._v(" "),t("el-form-item",{attrs:{label:"收款名",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入收款名"},model:{value:n.collectionForm.name,callback:function(e){n.$set(n.collectionForm,"name",e)},expression:"collectionForm.name"}})],1),n._v(" "),3==n.collectionForm.type?t("el-form-item",{attrs:{label:"银行账号",prop:"account_num"}},[t("el-input",{attrs:{placeholder:"请输入银行账号"},model:{value:n.collectionForm.account_num,callback:function(e){n.$set(n.collectionForm,"account_num",e)},expression:"collectionForm.account_num"}})],1):n._e(),n._v(" "),3==n.collectionForm.type?t("el-form-item",{attrs:{label:"银行名称",prop:"bank_name"}},[t("el-input",{attrs:{placeholder:"请输入银行名称"},model:{value:n.collectionForm.bank_name,callback:function(e){n.$set(n.collectionForm,"bank_name",e)},expression:"collectionForm.bank_name"}})],1):n._e(),n._v(" "),3==n.collectionForm.type?t("el-form-item",{attrs:{label:"开户行",prop:"deposit_bank"}},[t("el-input",{attrs:{placeholder:"请输入开户行"},model:{value:n.collectionForm.deposit_bank,callback:function(e){n.$set(n.collectionForm,"deposit_bank",e)},expression:"collectionForm.deposit_bank"}})],1):n._e(),n._v(" "),2==n.account_type&&3==n.collectionForm.type?t("el-form-item",{attrs:{label:"预留手机",prop:"bank_mobile"}},[t("el-input",{attrs:{placeholder:"请输入预留手机"},model:{value:n.collectionForm.bank_mobile,callback:function(e){n.$set(n.collectionForm,"bank_mobile",e)},expression:"collectionForm.bank_mobile"}})],1):n._e(),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("collectionForm")}}},[n._v("提交")]),n._v(" "),t("el-button",{on:{click:function(e){n.resetForm("collectionForm")}}},[n._v("返回")])],1)],1)},staticRenderFns:[]};var F=t("VU/8")(y,g,!1,function(n){t("SNNS")},null,null).exports,w={computed:{qiniuUpload:function(){return"http://up.qiniu.com"},avatar:function(){return"http://res.shiyin.net/"+this.wechatForm.kf_img}},data:function(){return{id:this.$route.params.id,showApp:!1,app_types:[],appList:{data:[],total:0},wechatForm:{webchat_name:"",original:"",kf_img:"",follow_type:"1",product_type:[]},wechatrules:{webchat_name:[{required:!0,message:"请输入公众号名称",trigger:"blur"}],original:[{required:!0,message:"请输入微信号原始ID",trigger:"blur"}],kf_img:[{required:!0,message:"请选择客服头像",trigger:"blur"}]},qiniuHost:"",tempWechatForm:{},uploadData:{},params:{page:1}}},created:function(){this.getCPSAppListFn()},methods:{getQiniuTokenFn:function(){var n=f()(u.a.mark(function n(){var e;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getQiniuToken");case 2:200==(e=n.sent).code&&(this.qiniuHost=e.host,this.uploadData={token:e.token});case 4:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),beforeAvatarUpload:function(){var n=f()(u.a.mark(function n(){var e;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getQiniuToken");case 2:if(200!=(e=n.sent).code){n.next=9;break}return this.qiniuHost=e.host,this.uploadData={token:e.token},n.abrupt("return",!0);case 9:return this.uploadData.token="",n.abrupt("return",!1);case 11:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),getCPSAppListFn:function(){var n=f()(u.a.mark(function n(){var e,t;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(e=this._.cloneDeep(this.params)).id=this.id,n.next=4,this.$store.dispatch("getCPSAppList",e);case 4:200==(t=n.sent).code&&(t.data.data.forEach(function(n){n.appid=n.cps_webchat_info?n.cps_webchat_info.appid:"-",n.auth_status=n.cps_webchat_info?n.cps_webchat_info.auth_status:"-"}),this.appList={data:t.data.data,total:t.data.total});case 6:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),showAppInfoFn:function(){var n=f()(u.a.mark(function n(e){var t,a,r;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("getCPSAppInfo",{id:e.id});case 2:200==(t=n.sent).code&&(a=t.data,this.wechatForm={img:a.img,wechat:a.wechat,webchat_name:a.webchat_name,appid:a.appid,original:a.original,secret:a.secret,kf_img:a.kf_img,follow_type:a.follow_type,encoding_key:a.encoding_key,domain:a.domain,js_domin:a.js_domin,web_author_domin:a.web_author_domin,server_url:a.server_url,token:a.token,admin_id:a.admin_id,id:a.cps_appid,product_type:[]},this.app_types=a.app_types,r=[],a.product_type.forEach(function(n){r.push(n.product_id)}),this.wechatForm.product_type=r,this.tempWechatForm=JSON.parse(d()(this.wechatForm)),this.showApp=!0);case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),handleCurrentChange:function(n){this.params.page=n,this.getCPSAppListFn()},handleAvatarSuccess:function(n){this.wechatForm.kf_img=n.key,this.avatar=this.qiniuHost+"/"+n.key},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return!1;e.putCPSUpdateAppFn()})},putCPSUpdateAppFn:function(){var n=f()(u.a.mark(function n(){var e;return u.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.wechatForm,n.next=3,this.$store.dispatch("putCPSUpdateApp",{id:e.id,webchat_name:e.webchat_name,admin_id:e.admin_id,original:e.original,kf_img:e.kf_img,follow_type:e.follow_type,product_type:e.product_type,updated_at:Object(l.k)(new Date)});case 3:200==n.sent.code&&(this.$message({type:"success",message:"修改成功",duration:1500}),this.getCPSAppListFn(),this.showApp=!0);case 5:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),resetForm:function(n){this.showApp=!1,this.$refs[n].resetFields()}}},k={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",[n.showApp?n._e():t("el-table",{staticStyle:{width:"100%"},attrs:{data:n.appList.data,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号","min-width":"80",fixed:""}}),n._v(" "),t("el-table-column",{attrs:{prop:"name",label:"应用名称","min-width":"150","show-overflow-tooltip":""}}),n._v(" "),t("el-table-column",{attrs:{prop:"appid",label:"公众号名称","min-width":"120"},scopedSlots:n._u([{key:"default",fn:function(e){return[n._v(n._s(e.row.cps_webchat_info?e.row.cps_webchat_info.webchat_name?e.row.cps_webchat_info.webchat_name:"-":e.row.name))]}}])}),n._v(" "),t("el-table-column",{attrs:{prop:"appid",label:"appID","min-width":"120"}}),n._v(" "),t("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"120"}}),n._v(" "),t("el-table-column",{attrs:{prop:"mobile",label:"状态","min-width":"120","show-overflow-tooltip":""},scopedSlots:n._u([{key:"default",fn:function(e){return["1"==e.row.auth_status?t("el-tag",{attrs:{type:"success"}},[n._v("已授权")]):n._e(),n._v(" "),"0"==e.row.auth_status?t("el-tag",{attrs:{type:"danger"}},[n._v("未授权")]):n._e()]}}])}),n._v(" "),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){n.showAppInfoFn(e.row)}}},[n._v("设置")])]}}])})],1),n._v(" "),t("div",{staticClass:"pagination-container clearfix"},[n.showApp?n._e():t("div",{staticClass:"float-left"},[t("global-pagination",{attrs:{"current-page":n.params.page,"page-size":n.params.per_page,"page-sizes":[20],layout:"total, sizes, prev, pager, next, jumper",total:n.appList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1)]),n._v(" "),n.showApp?t("el-form",{ref:"wechatForm",staticClass:"demo-ruleForm",staticStyle:{width:"600px"},attrs:{model:n.wechatForm,"label-width":"150px",rules:n.wechatrules}},[t("el-form-item",{attrs:{label:"公众号名称",prop:"webchat_name"}},[t("el-input",{model:{value:n.wechatForm.webchat_name,callback:function(e){n.$set(n.wechatForm,"webchat_name",e)},expression:"wechatForm.webchat_name"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"原始ID",prop:"original"}},[t("el-input",{model:{value:n.wechatForm.original,callback:function(e){n.$set(n.wechatForm,"original",e)},expression:"wechatForm.original"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"关注模式"}},[t("el-radio-group",{model:{value:n.wechatForm.follow_type,callback:function(e){n.$set(n.wechatForm,"follow_type",e)},expression:"wechatForm.follow_type"}},[t("el-radio",{attrs:{label:1}},[n._v("主动关注")]),n._v(" "),t("el-radio",{attrs:{label:2}},[n._v("强制关注")])],1)],1),n._v(" "),t("el-form-item",{attrs:{label:"产品种类"}},[t("el-checkbox-group",{model:{value:n.wechatForm.product_type,callback:function(e){n.$set(n.wechatForm,"product_type",e)},expression:"wechatForm.product_type"}},n._l(n.app_types,function(e){return t("el-checkbox",{key:e.id,attrs:{label:e.id}},[n._v(n._s(e.name))])}))],1),n._v(" "),t("el-form-item",{attrs:{label:"客服头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:n.qiniuUpload,"show-file-list":!1,"on-success":n.handleAvatarSuccess,data:n.uploadData,"before-upload":n.beforeAvatarUpload}},[n.wechatForm.kf_img?t("img",{staticClass:"avatar",attrs:{src:n.avatar}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),n._v(" "),t("el-form-item",{attrs:{label:"微信号"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.wechat,callback:function(e){n.$set(n.wechatForm,"wechat",e)},expression:"wechatForm.wechat"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"二维码"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.img,callback:function(e){n.$set(n.wechatForm,"img",e)},expression:"wechatForm.img"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"APP ID"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.appid,callback:function(e){n.$set(n.wechatForm,"appid",e)},expression:"wechatForm.appid"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"APP secret"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.secret,callback:function(e){n.$set(n.wechatForm,"secret",e)},expression:"wechatForm.secret"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"token"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.token,callback:function(e){n.$set(n.wechatForm,"token",e)},expression:"wechatForm.token"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"EncodingAESKey"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.encoding_key,callback:function(e){n.$set(n.wechatForm,"encoding_key",e)},expression:"wechatForm.encoding_key"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"业务域名"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.domain,callback:function(e){n.$set(n.wechatForm,"domain",e)},expression:"wechatForm.domain"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"JS接口安全域名"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.js_domin,callback:function(e){n.$set(n.wechatForm,"js_domin",e)},expression:"wechatForm.js_domin"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"网页授权域名"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.web_author_domin,callback:function(e){n.$set(n.wechatForm,"web_author_domin",e)},expression:"wechatForm.web_author_domin"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"URL(服务器地址)"}},[t("el-input",{attrs:{disabled:""},model:{value:n.wechatForm.server_url,callback:function(e){n.$set(n.wechatForm,"server_url",e)},expression:"wechatForm.server_url"}})],1),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("wechatForm")}}},[n._v("提交")]),n._v(" "),t("el-button",{on:{click:function(e){n.resetForm("wechatForm")}}},[n._v("返回")])],1)],1):n._e()],1)},staticRenderFns:[]};var x=t("VU/8")(w,k,!1,function(n){t("Jrw8")},null,null).exports,$={data:function(){return{id:this.$route.params.id,domainForm:{url:"",transfers_domain:"",floor_domain:""},domainrules:{transfers_domain:[{required:!0,message:"请输入中转域名",trigger:"blur"}],floor_domain:[{required:!0,message:"请输入落地域名",trigger:"blur"}]},specialAgent:{domain:"",api:"",params:{}}}},components:{UrlList:c.a},mounted:function(){this.getAgentInfoDomain()},methods:{postUpdateOrCreateAgentInfo:function(){var n=this,e={admin_id:this.id};if(1==this.specialAgent.use_parent_set)e.use_parent_set=1;else{var t=this.$refs.urlList.urlAll,a=this.$refs.urlList.getAll(),r=Object(l.f)(t.mid_menu),o=Object(l.f)(t.mid_promote),s=t.mid_msg,i=Object(l.f)(t.mid_activity),c=Object(l.f)(t.fall_menu),p=Object(l.f)(t.fall_promote),u=t.fall_msg,m=Object(l.f)(t.fall_activity),_=Object(l.f)(t.fall_pay);if(e.use_parent_set=0,!this.$refs.urlList.hasSame())return;e.mid_menu=d()(r),e.mid_promote=d()(o),e.mid_msg=d()(s),e.mid_activity=d()(i),e.fall_menu=d()(c),e.fall_promote=d()(p),e.fall_msg=d()(u),e.fall_activity=d()(m),e.fall_pay=d()(_),e.unique_array=d()(a)}this.$store.dispatch("postUpdateOrCreateAgentInfo",e).then(function(e){200==e.code&&(Object(l.i)("修改成功"),setTimeout(function(){n.closeSelectedTag("/CPSManage/accounts")},1500))})},getAgentInfoDomain:function(){var n=this,e={};this.$store.dispatch("getAgentInfoDomain",{id:this.id}).then(function(t){if(200==t.code){var a=t.data,r=Object(l.j)(a.mid_menu),o=Object(l.j)(a.mid_promote),s=a.mid_msg,i=Object(l.j)(a.mid_activity),c=Object(l.j)(a.fall_menu),p=Object(l.j)(a.fall_promote),u=a.fall_msg,m=Object(l.j)(a.fall_activity),d=Object(l.j)(a.fall_pay);e.use_parent_set=a.parentSet?a.parentSet.use_parent_set+"":"1",0==s.length&&(s=[{domain:"",flag:""}]),0==u.length&&(u=[{domain:"",flag:""}]),e.params={mid_menu:r,mid_promote:o,mid_msg:s,mid_activity:i,fall_menu:c,fall_promote:p,fall_msg:u,fall_activity:m,fall_pay:d},t.data.specialAgent&&(e.api=a.specialAgent.api,e.domain=a.specialAgent.domain,n.specialAgent=e)}})},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return!1;e.postUpdateOrCreateAgentInfo()})},resetForm:function(n){this.showApp=!1,this.$refs[n].resetFields(),this.closeSelectedTag("/CPSManage/accounts")}}},A={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-form",{ref:"domainForm",staticClass:"demo-ruleForm",staticStyle:{width:"600px"},attrs:{model:n.domainForm,"label-width":"100px",rules:n.domainrules}},[t("el-form-item",{attrs:{label:"B端后台域名",prop:"url"}},[t("el-input",{attrs:{disabled:""},model:{value:n.specialAgent.domain,callback:function(e){n.$set(n.specialAgent,"domain",e)},expression:"specialAgent.domain"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"API",prop:"url"}},[t("el-input",{attrs:{disabled:""},model:{value:n.specialAgent.api,callback:function(e){n.$set(n.specialAgent,"api",e)},expression:"specialAgent.api"}})],1),n._v(" "),t("el-form-item",{attrs:{label:"域名"}},[t("el-radio",{attrs:{label:"1"},model:{value:n.specialAgent.use_parent_set,callback:function(e){n.$set(n.specialAgent,"use_parent_set",e)},expression:"specialAgent.use_parent_set"}},[n._v("与上级代理一致")]),n._v(" "),t("el-radio",{attrs:{label:"0"},model:{value:n.specialAgent.use_parent_set,callback:function(e){n.$set(n.specialAgent,"use_parent_set",e)},expression:"specialAgent.use_parent_set"}},[n._v("自定义")])],1),n._v(" "),t("url-list",{directives:[{name:"show",rawName:"v-show",value:0==n.specialAgent.use_parent_set,expression:"specialAgent.use_parent_set==0"}],ref:"urlList",attrs:{params:n.specialAgent.params}}),n._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(e){n.submitForm("domainForm")}}},[n._v("提交")]),n._v(" "),t("el-button",{on:{click:function(e){n.resetForm("domainForm")}}},[n._v("返回")])],1)],1)},staticRenderFns:[]};var S=t("VU/8")($,A,!1,function(n){t("qi1d")},null,null).exports,C={computed:s()({},Object(i.b)({cpsAccountType:"cpsAccountType"}),{qiniuUpload:function(){return"http://up.qiniu.com"},avatar:function(){return"http://res.shiyin.net/"+this.wechatForm.kf_img}}),components:{UrlList:c.a,EditInfo:b,EditReceipt:F,EditVipcn:x,EditDomain:S},watch:{},data:function(){return{activeName:"info"}},created:function(){},methods:{handleClick:function(){this.activeName}}},j={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"app-container"},[t("el-tabs",{on:{"tab-click":n.handleClick},model:{value:n.activeName,callback:function(e){n.activeName=e},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"个人信息",name:"info"}},["info"==n.activeName?t("edit-info"):n._e()],1),n._v(" "),t("el-tab-pane",{attrs:{label:"收款信息",name:"receipt"}},["receipt"==n.activeName?t("edit-receipt"):n._e()],1),n._v(" "),t("el-tab-pane",{attrs:{label:"应用信息",name:"vipcn"}},["vipcn"==n.activeName?t("edit-vipcn"):n._e()],1),n._v(" "),t("el-tab-pane",{attrs:{label:"域名配置",name:"domain"}},["domain"==n.activeName?t("edit-domain"):n._e()],1)],1)],1)},staticRenderFns:[]};var P=t("VU/8")(C,j,!1,function(n){t("gA9Q")},null,null);e.default=P.exports}});