webpackJsonp([109],{OXon:function(n,t,e){var a=e("lTAu");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("ebe06dd2",a,!0)},kYO9:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("woOf"),i=e.n(a),l=e("Xxa5"),r=e.n(l),s=e("exGp"),o=e.n(s),c=e("Dd8w"),u=e.n(c),p=e("NYxO"),d=e("/y5F"),h=e("TIfe"),v={name:"authorManageSigned",components:{SearchCondition:d.a},computed:u()({},Object(p.b)({authorSignList:"authorSignList"})),watch:{},data:function(){return{value:"0",signs:[{value:"all",label:"全部"},{value:"0",label:"无签约"},{value:"1",label:"全勤签约"},{value:"2",label:"保底签约"},{value:"3",label:"买断签约"}],approvalStates:[{value:"all",label:"全部"},{value:"0",label:"待审核"},{value:"1",label:"审核通过"},{value:"2",label:"审核驳回"}],contractStates:[{value:"all",label:"全部"},{value:"0",label:"未签署"},{value:"1",label:"已签署"},{value:"2",label:"重新签署"},{value:"3",label:"作者作废合同"}],loading:!1,batchVisible:!1,params:{page:1,name:"",pen_name:"",status:"all",book_id:"",sign:"all",is_sign:"all"},size:20,role_type:"",admin_id:""}},created:function(){this.role_type=Object(h.d)().role_type,this.admin_id=Object(h.d)().admin_id,this.getAuthorSignList()},methods:{getAuthorSignPreviewFn:function(){var n=o()(r.a.mark(function n(t){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:window.open("/admin/author/sign_preview?id="+t);case 1:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),handleCurrentChange:function(n){this.params.page=n,this.getAuthorSignList()},getSearchFn:function(n){this.params=i()(this.params,n),this.fuzzyQueryFn()},fuzzyQueryFn:function(){this.params.page=1,this.getAuthorSignList()},getAuthorSignList:function(){var n=o()(r.a.mark(function n(){var t,e;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:for(e in this.loading=!0,t=this._.clone(this.params))"all"==t[e]&&delete t[e];return t.role_type=this.role_type,t.admin_id=this.admin_id,n.next=7,this.$store.dispatch("getAuthorSignList",t);case 7:this.loading=!1;case 8:case"end":return n.stop()}},n,this)}));return function(){return n.apply(this,arguments)}}(),postAuthorSignRemarkEditFn:function(){var n=o()(r.a.mark(function n(t){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postAuthorSignRemarkEdit",{id:t.id,remark:t.remark||"  "});case 2:200==n.sent.code?this.$message({duration:1500,message:"添加备注成功！",type:"success"}):this.getAuthorSignList();case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}(),changeSignedStatusFn:function(n){var t=this;1==n.status?this.$confirm("确定通过审核吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){t.postAuthorSignStatus(1,n.id)}).catch(function(){}):2==n.status?this.$prompt("请输入驳回原因","申请驳回",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){var a=e.value;t.postAuthorSignStatus(2,n.id,a)}).catch(function(){}):t.postAuthorSignStatus(0,n.id)},postAuthorSignStatus:function(){var n=o()(r.a.mark(function n(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postAuthorSignStatus",{id:e,status:t,content:a});case 2:200==n.sent.code&&(this.$message({duration:1500,message:"操作成功！",type:"success"}),this.getAuthorSignList());case 4:case"end":return n.stop()}},n,this)}));return function(t,e){return n.apply(this,arguments)}}(),postSignDestroyFn:function(){var n=o()(r.a.mark(function n(t){return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.$store.dispatch("postSignDestroy",{id:t});case 2:200==n.sent.code&&(this.$message({duration:1500,message:"作废成功！",type:"success"}),this.getAuthorSignList());case 4:case"end":return n.stop()}},n,this)}));return function(t){return n.apply(this,arguments)}}()}},g={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container"},[e("div",{staticClass:"bar flex"},[e("div",{staticClass:"flex-left"},[e("label",{staticClass:"radio-label",staticStyle:{"padding-left":"0"}},[n._v("签约类型")]),n._v(" "),e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择签约类型"},on:{change:n.fuzzyQueryFn},model:{value:n.params.sign,callback:function(t){n.$set(n.params,"sign",t)},expression:"params['sign']"}},n._l(n.signs,function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})})),n._v(" "),e("label",{staticClass:"radio-label"},[n._v("审批状态")]),n._v(" "),e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择审批状态"},on:{change:n.fuzzyQueryFn},model:{value:n.params.status,callback:function(t){n.$set(n.params,"status",t)},expression:"params['status']"}},n._l(n.approvalStates,function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})})),n._v(" "),e("label",{staticClass:"radio-label"},[n._v("合同状态")]),n._v(" "),e("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择合同状态"},on:{change:n.fuzzyQueryFn},model:{value:n.params.is_sign,callback:function(t){n.$set(n.params,"is_sign",t)},expression:"params['is_sign']"}},n._l(n.contractStates,function(n){return e("el-option",{key:n.value,attrs:{label:n.label,value:n.value}})}))],1),n._v(" "),e("div",{staticClass:"flex-right"},[e("search-condition",{on:{search:n.getSearchFn}})],1)]),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],staticStyle:{width:"100%","text-align":"center"},attrs:{data:n.authorSignList.data,border:"",stripe:""}},[e("el-table-column",{attrs:{prop:"book_id",label:"小说ID","min-width":"80",fixed:""}}),n._v(" "),e("el-table-column",{attrs:{prop:"bookname",label:"小说名称","min-width":"150","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"username",label:"作者笔名","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"created_at",label:"所属分类","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"sign",label:"签约类型","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"contractId",label:"合同ID","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"_is_sign",label:"合同状态","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"qq",label:"QQ","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"updated_at",label:"审批状态","min-width":"120","show-overflow-tooltip":"",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){n.changeSignedStatusFn(t.row)}},model:{value:t.row.status,callback:function(e){n.$set(t.row,"status",e)},expression:"scope.row.status"}},[e("el-option",{attrs:{value:0,label:"待审核"}}),n._v(" "),e("el-option",{attrs:{value:1,label:"通过"}}),n._v(" "),e("el-option",{attrs:{value:2,label:"驳回"}})],1)]}}])}),n._v(" "),e("el-table-column",{attrs:{prop:"created_at",label:"申请时间","min-width":"120","show-overflow-tooltip":"",align:"center"}}),n._v(" "),e("el-table-column",{attrs:{prop:"updated_at",label:"备注","min-width":"120","show-overflow-tooltip":"",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("el-input",{on:{change:function(e){n.postAuthorSignRemarkEditFn(t.row)}},model:{value:t.row.remark,callback:function(e){n.$set(t.row,"remark",e)},expression:"scope.row.remark"}})]}}])}),n._v(" "),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"210",align:"center"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("router-link",{attrs:{to:"/authorManage/signed/edit/"+t.row.id}},[e("el-button",{attrs:{size:"mini",type:"primary"}},[n._v("编辑")])],1),n._v(" "),e("el-button",{attrs:{size:"mini",type:"warning",disabled:"-"==t.row.contractId},on:{click:function(e){n.getAuthorSignPreviewFn(t.row.id)}}},[n._v("预览")]),n._v(" "),e("el-popover",{attrs:{placement:"top",width:"100"},model:{value:t.row.delete,callback:function(e){n.$set(t.row,"delete",e)},expression:"scope.row.delete"}},[e("p",[n._v("确认作废选择的合同？")]),n._v(" "),e("div",{staticStyle:{"text-align":"right",margin:"0"}},[e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){t.row.delete=!1}}},[n._v("取消")]),n._v(" "),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.row.delete=!1,n.postSignDestroyFn(t.row.id)}}},[n._v("确定")])],1),n._v(" "),3!=t.row.is_sign?e("el-button",{attrs:{slot:"reference",size:"mini",type:"danger",disabled:"-"==t.row.contractId},on:{click:function(n){t.row.delete=!0}},slot:"reference"},[n._v("作废")]):n._e()],1),n._v(" "),3==t.row.is_sign?e("el-button",{attrs:{type:"info",disabled:""}},[n._v("已作废")]):n._e()]}}])})],1),n._v(" "),e("div",{staticClass:"pagination-container clearfix"},[e("div",{staticClass:"float-left"},[e("global-pagination",{attrs:{"current-page":n.params.page,"page-size":n.params.per_page,layout:"total, sizes, prev, pager, next, jumper",total:n.authorSignList.total},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange}})],1)])],1)},staticRenderFns:[]};var f=e("VU/8")(v,g,!1,function(n){e("OXon")},null,null);t.default=f.exports},lTAu:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});